s.bhuvanesh@live.in
123


function d(){
var person = [{
  firstName : 1,  lastName : 'Sender'},
  { firstName : 2,  lastName : 'Sehjnder'},
  { firstName : 3,  lastName : 'Sehjnder'},
  { firstName : 4,  lastName : 'Sehjnder'},
  { firstName : 5,  lastName : 'Sehjnder'},
  { firstName : 6,  lastName : 'Sehjnder'}
  ];

var person1 = [{
  firstName : 2,  lastName : 'Sender'},{
 firstName : 4,  lastName : 'Sehjnder'
}];


       
        var rest1 = { name1: ""};
        var res1 = [];
        for(var i=0; i<person.length;i++){
                rest1.name1=person[i].firstName
                 res1.push(rest1);
                 var rest1 = { name1: ""};
               }
               
               
               
                var rest2 = { name1: ""};
                var res2 = [];
               for(var i=0; i<person1.length;i++){
                rest2.name1=person1[i].firstName
                 res2.push(rest2);
                 var rest2 = { name1: ""};
               }



        var a=res1.length;
        var b=res2.length;
        alert(a);
        alert(b);
        
        for(var i=0;i<a;i++)
        {
        for(var j=0;j<b;j++){
        if(res1[i].name1==res2[j].name1){
        alert("same");
        }else{
        alert("Not");
        }
        }
         
        }
       
        
}
d();

<ion-view view-title="Appointments">
<style type="text/css">
    .bar-cblue,.cbtn
    {
        background-color: #06A1CF !important;
        opacity: 0.9;
    }
    .cbar
    {
        height: 38px !important;
    }
    .cborder{
       border-color:#0B7B9C !important;
    }
    .cbtn
    {
        min-height: 25px !important;
        line-height: 19px !important;
    }
</style>

    <ion-nav-buttons side="secondary">
        <button class="button button-icon button-clear padding-right" ng-click="openSearch()">
            <!--<i class="ion-android-search padding-right"></i>-->
            <i style="font-size: x-large; margin-right: 20px;" ng-class="{'ion-android-search': platform.isAndroid(), 'ion-ios-search-strong':platform.isIOS()}" class="padding-right"></i>
        </button>
        <button class="button button-icon button-clear padding-right" ng-click="popover.show($event)">
            <i style="font-size: x-large; margin-right: 20px;" ng-class="{'ion-android-more-vertical': platform.isAndroid(), 'ion-ios-cog-outline':platform.isIOS()}" class="padding-right"></i>
        </button>
    </ion-nav-buttons>


    <ion-content ng-class="{'has-tabs-top': platform.isAndroid()}" class="has-header">
        <ion-header-bar align-title="left" class="bar-positive bar-cblue cbar">
            <div class="buttons">
                <button class="button cbtn cborder" ng-click="getAppointmentList()">Today</button>
            </div>
            <p class="title" style="left: 55px;font-size: 13px;top: -4px;">{{Selecteddate}}</p>
<div class="buttons" style="margin-right: 5px;margin-top: 1px;">
    <ionic-datepicker input-obj="datepickerObject">
              <i class="ion-android-calendar" style="font-size: 26px;"></i>
    </ionic-datepicker>
</div>
        </ion-header-bar>
        <div class="list list-inset" style="
    margin-top: 2px;
    margin-bottom: 2px;
">
            <label class="item item-input" ng-hide="appoints_list" style="margin-top: 43px;">
                <i class="icon ion-search placeholder-icon"></i>
                <input type="text" placeholder="Search my appointments">
            </label>
        </div>
<br/>
        <div id="appoints_list" ng-show="appoints_list">

            <div ng-include src="'templates/norecords.html'"></div>

        </div>

        <!--<div ng-repeat="y in totaldays">-->
            <!--<p>{{y | date :'EEEE,dd MMMM yyyy'}}</p>-->
            <div ng-repeat="ite in fj">
                <p>{{ite.name}}</p>

        <div ng-repeat="x in patientList"  class="animate-repeat" ng-class="" >
            <!--ng-click="todetailspage('{{x.doctorId}}','{{x.specialityId}}')"-->
            
            
            
            
            <div ng-if="ite.name == x.Appointmentdate">

            <div class="list card" disabled="true" ng-repeat-end="" style="margin-top:1px">

                <div class="item item-avatar">

                    <img ng-src={{"http://182.73.141.106/Mobile/PatientWebApi/api/Patient/GetProfileImage?id="+x.patientId}}>

                    <h5>{{x.PatientName}}</h5>

                    <div>
                        <small style="font-size: x-small">Appointment Date : {{x.Appointmentdate}}</small>
                        <br/>
                        <small style="font-size: x-small"> Appointment Time : {{x.AppointmentTime}}</small>

                    </div>

                    </div>
                </div>

                <!--<div class="item item-image">-->
                    <!--<div class="col-90 center" ng-hide="y==x.Appointmentdate">No appointments found in this date</div>-->
                <!--</div>-->


                <!--<div style="color: #b2b2b2;" class="item tabs tabs-secondary tabs-icon-left pull-right">-->
                    <!--<a class="tab-item" href="#" ng-click="onthumbsup('{{x.doctorId}}')">-->
                        <!---->
                        <!--<i class="icon ion-thumbsup">-->
                            <!--<small style="font-size: x-small">39</small>-->
                        <!--</i>-->
                    <!--</a>-->
                    <!--<a class="tab-item" href="#" ng-click="onthumbsdown('{{x.doctorId}}')">-->
                        <!--<i class="icon ion-thumbsdown">-->
                            <!--<small style="font-size: x-small">9</small>-->
                        <!--</i>-->
                    <!--</a>-->

                    <!--<a class="tab-item" href="#" ng-click="onchatclick('{{x.doctorId}}')">-->
                        <!--<i class="icon ion-ios-chatbubble"></i>-->
                        <!--Chat-->
                    <!--</a>-->
                    <!--<a class="tab-item" href="#" ng-show="checkstatus('{{x.status}}');"-->
                       <!--ng-click="cancelapp('{{x.appointmentId}}')">-->
                        <!--<i class="icon ion-android-delete"></i>-->
                        <!--Cancel-->
                    <!--</a>-->

                    <!--<a class="tab-item" href="#" ng-hide="checkstatus('{{x.status}}');"-->
                       <!--ng-click="openviewDocument('{{x.appointmentId}}')">-->
                        <!--<i class="icon ion-android-attach"></i>-->
                        <!--Docs-->
                    <!--</a>-->

                <!--</div>-->

                <!--<a class="item item-icon-left assertive text-center" ng-click="tobookingpage('{{x.doctorId}}')">

                    <i class="icon ion-ios-medkit"></i>
                    Book
                </a>-->

            </div>

            <!-- -->
        </div>
        </div>
<div>



</div>

        <br/>
        <br/>
        <br/>
    </ion-content>
</ion-view>




http://www.completecsharptutorial.com/basic/return.php


var a = parseInt(item.length);
                    var b = item;

                    for (var i = 0; i < b.length; i++) {
                        //var c = b[i];
                        //alert(b[0]);
                        //alert(c);


function TodoCtrl($scope,$filter) {




  

var f = $filter('date')(new Date(), 'EEEE');
var s = $filter('date')(new Date(), 'EEEE,d'+1);
var t = $filter('date')(new Date(), 'MMM'); //01-31 like
var f = $filter('date')(new Date(),'y');//2014 like
alert(s);
var s1 =s + 1;

var someFormattedDate = f + ','+ s1 + ' '+ t+ ','+ f;
alert(someFormattedDate);


var someDate = new Date('2014-05-14');
someDate.setDate(someDate.getDate() + 1); 
var dateFormated = someDate.toISOString().substr(0,10);
//alert(dateFormated);

  var c = $filter('date')(new Date(), 'EEEE,d MMM, y');
  //alert(c);
}


                        //$("<option>" + c[i] + "</option>").appendTo("#drop2");
                        //$("<option>" + c + "</option>").appendTo("#drop2");
                        $("#dum").after("<tr><td>" + b[0] + "</td></tr>");
                    }


>
>select * from tb_example1
>
>
>insert into tb_example1 (nm_example)values('Item de paginaco2'+ convert (varchar,isnull (@@identity,0)))
>go 100

{
//        "sName": "Delete", "fnRender": function (oObj) {
//            return "<td class='hithi'  id='Edit'> <input type='button' id='edittt' class='btn btn-primary' value='Over'/></td>"
//        }
//    },

http://jsfiddle.net/8CHTm/1/
c# error
1)The remote server returned an error: (407) Proxy Authentication Required.


 public string SendNotifications(string message, string device_token)
        {
            var applicationID = "AIzaSyC40Mfh333gelwCZiPlg9r3o2_Z-WFi0Mc";   // Google Api server key
            var SENDER_ID = "295163319566"; // Google project number
            var title = "Continental Hospitals";
            WebRequest tRequest;
            NetworkCredential nc = new NetworkCredential();
            tRequest = WebRequest.Create("https://android.googleapis.com/gcm/send");
            tRequest.Method = "post";
            tRequest.ContentType = " application/x-www-form-urlencoded;charset=UTF-8";
            tRequest.Headers.Add(string.Format("Authorization: key={0}", applicationID));

            tRequest.Headers.Add(string.Format("Sender: id={0}", SENDER_ID));

            string postData = "collapse_key=score_update&time_to_live=2419200&badge=true&priority=high&delay_while_idle=1&data.message="
            + message + "&data.title=" + title + "&data.time=" + System.DateTime.Now.ToString() + "&registration_id=" + device_token + "";

            Byte[] byteArray = Encoding.UTF8.GetBytes(postData);
            tRequest.ContentLength = byteArray.Length;

            Stream dataStream = tRequest.GetRequestStream();
            dataStream.Write(byteArray, 0, byteArray.Length);
            dataStream.Close();
            WebResponse tResponse = tRequest.GetResponse();
           
            dataStream = tResponse.GetResponseStream();
            StreamReader tReader = new StreamReader(dataStream);
            String sResponseFromServer = tReader.ReadToEnd();
            tReader.Close();
            dataStream.Close();
            tResponse.Close();




            //var d = setnotificationflag(device_token);
            return postData;
        }





9-12-2015(alagu,majo) (evening)(8)
10-12-2015(alagu,majo,vignesh) (evening)(9)
13-12-2015(alagu,majo,prakash) (Morning)(8)
13-12-2015(alagu,prakash) (evening)(5)
14-12-2015(alagu,prakash) (evening)(6)

(25)
15-12-2015(alagu,prakash) (evening)(4)
16-12-2015(alagu,majo,prakash) (evening)(12)
18-12-2015(alagu,majo,prakash) (evening)(12)
19-12-2015(alagu,majo,prakash) (evening)(15)
20-12-2015(alagu,majo,prakash) (evening)(20)
22-12-2015(alagu,kanathasan,prakash)(enening)(12)
23-12-2015(alagu,kanathasan,prakash)(enening)(15)


http://localhost:56521/DoctorMobileService/PatientDetails.svc/Register?patient={"mobile":"9042619379","email":"s.bhuvanesh@live.in","password":"123","activeFlag":"0","isVerified":"0","Type":"1"}


Update :
Edit?Patient={"patientId":"3","firstName":"","lastName":"","mobile":"","dob":"2015-02-24","genderId":"1","bloodGroupId":"1"
                    ,"fathersName":"Sekar","fathersEmail":"","fathersMobile":"","mothersName":"Rajeswari","mothersEmail":"","mothersMobile":""
                    ,"countryName":"India","stateName":"Tamilnadu","cityName":"Chennai","address":"chennai","maritalId":"1","pincode":"600075" }










To do there are four table based on the sales this tables will be based on the model then the data will be taken from controller based on the sales


ToText(Date(CDateTime ({?@fromdate})), "dd-MMM-yyyy")
ipconfig /renew  for ip address

http://codepen.io/amsul/pen/nGckA
"data:image/png;base64,aW1hZ2U="

windows.onbeforeunload
>>>>>>>>>>>>>>>>
file://web-server/ApolloMVCSourcesRep

  return Json(new SimpleResponse());

public ActionResult Test()
{
 return Json(res);
}
 --Edit_user_profile 5,'test','testss','2016/01/20','','',''


            var res = [];

            debugger
            var rest = { "name": "", "y": "" };
            for (i = 0; i < result.length; i++) {
                rest.name = result[i].BillingState;
                //  alert(rest.name);
                rest.y = result[i].BillAmount;
                //   alert(rest.y);
                res.push(rest);
                rest = { "name": "", "y": "" };
            }





Monday,15 FEB 2016
http://codepen.io/anon/pen/MwVNpq

http://forums.asp.net/t/1772631.aspx?Using+Sockets+with+c+


http://stackoverflow.com/questions/27600863/mysql-monthly-sale-of-last-12-months-including-months-with-no-sale


formatAMPM(slot.timeSlot) < time1()&& nex()!=1 ||slot.appointmentStatus==1

formatAMPM(slot.timeSlot) < time1() &&  nex!=1|| nowdate1()!=nowdate2()||slot.appointmentStatus==1

rename the procedure
EXEC sp_rename 'sp_MyProc', 'sp_MyProcName'
sp_rename <oldname> <newname>

change the datatype of coloumn in sql
ALTER TABLE tablename
ALTER COLUMN coulumnname columndatatype(size)


internal

core of .net


blazingbhuvan@gmail.com	
123

shajivinu.ss.sd@gmail.com
msalaguraj100@gmail.com



$scope.Todaydate = new Date();

$scope.CurrentDate = DateFormat(currentDate);


  var series2 = [];
                var Assignedto = [];


                for (i = 0; i < result.length; i++) {

                    series2.push([result[i].Name]);
                    Assignedto.push([result[i].AmountPaid]);


                }


<div class="col-20 slot-list" ng-repeat="slot in appointmentSlots"><button ng-disabled="isThisDisabled()" ng-click="BookSlot(slot.timeSlot)" ng-class="{selectTime : slot.timeSlot === selectedTIme}"class="button">


<input type="text" ng-model="myInput" />
isThisDisabled()?  false : true

slot.appointmentStatus==1 && 
slot.timeSlot < majo
formatAMPM(slot.timeSlot) < majo()


09:30 AM
12:30 PM


$scope.majo=function(){
debugger
        //var time="02:15 PM";
        var time=strTime;
        var hou, minute;
        if(time.split(" ")[1] == 'PM' && time.split(":")[0] != '12') {
            hou = parseInt(time.split(":")[0]) + 12;
        } else {
            hou = parseInt(time.split(":")[0]);
        }
        return hou;

    }



$scope.formatAMPM=function(time){
    //debugger
        var hour, minute;
        if(time.split(" ")[1] == 'PM' && time.split(":")[0] != '12') {
            hour = parseInt(time.split(":")[0]) + 12;
        } else {
            hour = parseInt(time.split(":")[0]);
        }
    return hour;

}


$scope.newDate =$filter('date')(collectionDate, 'EEEE, MMMM d, y');




1-7-2015----not put traker.
poclosed--saw
http://www.bms.wibrant.com/BMSWeb/login/index2

http://www.gojs.net/latest/samples/sankey.html

http://bootstrapmaster.com/live/simpliq2/charts-xcharts.html

5-3-2015
7-16-2015
To do there are four pie chart with controller. then to do put the data picker in each charts then if select the data picker means to take the values from the data base using the ajax function. then to display the all charts.

To learn how to use the styles in different styles then to learn drop down chart using the different styles then to put some sample using the chart .then to learn how to take the vaules from the back end then to bind the values from the database

_____________

To learn how to use the chart with controller in front end using the razer. then to learn how to use the connection strings in the chart function then to try the chart function in the different chart function useing based on razer function

<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/highcharts-3d.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>


html
 {
     background: -webkit-linear-gradient(180deg, #1a2980 0%, #4fabf7 100%);
   
     }


vikimdt2014@gmail.com


--------------------------sql




declare @fromdate datetime
declare @todate datetime
DECLARE @temptable TABLE(dateapo varchar(30))

set @fromdate = '2016-02-01 00:00:00.000'
--set @todate = '2016-02-28 00:00:00.000'
--set @fromdate = CONVERT(VARCHAR(10), GETDATE(), 120)
set @todate = CONVERT(VARCHAR(10), DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,GETDATE())+1,0)), 120)


--select CONVERT(VARCHAR(10), GETDATE(), 103)
--select CONVERT(VARCHAR(10), GETDATE(), 105)
--SELECT CONVERT(VARCHAR(10), GETDATE(), 120) AS [YYYY-MM-DD]
--SELECT DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,GETDATE())+1,0))
--SELECT CONVERT(VARCHAR(10), DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,GETDATE())+1,0)), 120)
;WITH cSequence
	AS (
		SELECT 1 AS StartRange
			,DATEADD(DD, 1, DATEADD(dd, - 1, @fromdate)) AS EndRange
					
		UNION ALL
		
		SELECT StartRange + 1
			,DATEADD(dd, 1, EndRange)
			
		FROM cSequence
		WHERE (
				DATEADD(dd, 1, EndRange) <= @todate
				--OR StartRange < 31
				)
		)
		
		
       insert into @temptable select CONVERT(VARCHAR(10),EndRange, 103) from cSequence
	   --select b.dateapo from @temptable b
	   select a.PatientName,a.AppointmentDate from appointment a 
	   SELECT c.PatientName,c.AppointmentDate, b.dateapo FROM @temptable b LEFT JOIN appointment c ON b.dateapo = c.AppointmentDate












--------------------controller




using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Data.SqlClient;
using HealthCareInMvc4.PurchaseOrderServiceRef;
using HealthCareInMvc4.IndentRequestServiceRef;
using HealthCareInMvc4.MainStoreSubStoreServiceRef;
using HealthCareInMvc4.RoleProfileServiceRef;
using System.Configuration;
using System.Data;
using HealthCareInMvc4.Controllers.Common;
using System.ServiceModel;
using HealthCareInMvc4.SalesOrderServicceRef;
using HealthCareInMvc4.Areas.Store.Models;
using HealthCareInMvc4.PatientDetailServiceRef;
using System.Web.UI.WebControls;

namespace HealthCareInMvc4.Areas.Store.Controllers
{
    public class DashboardController : Controller
    {
        //
        // GET: /Store/Dashboard/

        string Servicepath = Convert.ToString(System.Web.Configuration.WebConfigurationManager.AppSettings["ServicePath"]);
        // private string ServicePath;
        public static string cs = ConfigurationManager.AppSettings["ConnectionString"];
        SqlConnection conn = null;
        SqlConnection con = null;
        SqlCommand cmd = null;
        SqlDataReader dr;


        #region IPChanges2

        public ActionResult IPChanges2()
        {
            week();
            day();
            month();
            DischargePatientbyweek();
            DischargePatientbyday();
            DischargePatientbymonth();
            //ViewBag.val1 = ipdaywise();
            //ViewBag.val2 = CashorPanelPatient();
            //ViewBag.val3 = ForeignornonforeignPatient();
            



            ViewBag.val2 = CashorPanelPatient();
            ViewBag.val3 = ForeignornonforeignPatient();
            Int64 flg = 2;
            ChartViewModel ch = new ChartViewModel();
            ch.monfinance = monwisefin();
            //ch.Qutfinance = Quaterwisefinance();
            ch.Daywisepat = dischargetimecalc();
            ch.todayperd = Todaypred();
            List<PatientDetail> li = new List<PatientDetail>();
            li = Todaypred();
            foreach (var a in li)
            {
                flg = a.AdmissionID;
            }
            ViewData["flag"] = flg;
            return View(ch);
        }

        public List<PatientDetail> dischargetimecalc()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_countodfregtime", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PatientDetail();
                        obj1.WardName = DBNull.Value.Equals(dr["WardName"]) ? "NIL" : Convert.ToString(dr["WardName"]);
                        obj1.Count1 = DBNull.Value.Equals(dr["totfifpat"]) ? 0 : Convert.ToInt64(dr["totfifpat"]);
                        obj1.Count2 = DBNull.Value.Equals(dr["totthipat"]) ? 0 : Convert.ToInt64(dr["totthipat"]);
                        obj1.Count3 = DBNull.Value.Equals(dr["totforpat"]) ? 0 : Convert.ToInt64(dr["totforpat"]);
                        obj1.Count4 = DBNull.Value.Equals(dr["totonehrpat"]) ? 0 : Convert.ToInt64(dr["totonehrpat"]);
                        //  obj1.Description = DBNull.Value.Equals(dr["Patdate"]) ? "NIL" : Convert.ToString(dr["Patdate"]);
                        //  obj1.Balance = DBNull.Value.Equals(dr["General"]) ? 0 : Convert.ToInt64(dr["General"]);
                        li.Add(obj1);
                    }
                } 
                return li;
            }
        }

        public ActionResult Quaterwisefinance()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_quarterwisefinance", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PatientDetail();
                        obj1.WardName = DBNull.Value.Equals(dr["MonthName"]) ? "NIL" : Convert.ToString(dr["MonthName"]);
                        obj1.Count1 = DBNull.Value.Equals(dr["billtotal"]) ? 0 : Convert.ToInt64(dr["billtotal"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }

        public List<PatientDetail> monwisefin()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_monthwisefinalbilldet", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PatientDetail();
                        //  obj1.AdmissionID = DBNull.Value.Equals(dr["flag"]) ? 2 : Convert.ToInt64(dr["flag"]);
                        //  obj1.Count1 = DBNull.Value.Equals(dr["Todayadm"]) ? 0 : Convert.ToInt64(dr["Todayadm"]);
                        //  obj1.Count2 = DBNull.Value.Equals(dr["Totdischarge"]) ? 0 : Convert.ToInt64(dr["Totdischarge"]); 
                        obj1.AreaName = DBNull.Value.Equals(dr["MonthName"]) ? null : Convert.ToString(dr["MonthName"]);
                        obj1.ConsultingFee = DBNull.Value.Equals(dr["billtotal"]) ? 0 : Convert.ToDouble(dr["billtotal"]);
                        //     obj1.Count4 = DBNull.Value.Equals(dr["totonehrpat"]) ? 0 : Convert.ToInt64(dr["totonehrpat"]);
                        //  obj1.Description = DBNull.Value.Equals(dr["Patdate"]) ? "NIL" : Convert.ToString(dr["Patdate"]);
                        //  obj1.Balance = DBNull.Value.Equals(dr["General"]) ? 0 : Convert.ToInt64(dr["General"]);
                        li.Add(obj1);
                    }
                }
                return li;
            }
        }
        public List<PatientDetail> Todaypred()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_todayprediction", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PatientDetail();
                        obj1.AdmissionID = DBNull.Value.Equals(dr["flag"]) ? 2 : Convert.ToInt64(dr["flag"]);
                        obj1.Count1 = DBNull.Value.Equals(dr["Todayadm"]) ? 0 : Convert.ToInt64(dr["Todayadm"]);
                        obj1.Count2 = DBNull.Value.Equals(dr["Totdischarge"]) ? 0 : Convert.ToInt64(dr["Totdischarge"]);
                        obj1.Count3 = DBNull.Value.Equals(dr["TotBedFree"]) ? 0 : Convert.ToInt64(dr["TotBedFree"]);
                        //     obj1.Count4 = DBNull.Value.Equals(dr["totonehrpat"]) ? 0 : Convert.ToInt64(dr["totonehrpat"]);
                        //  obj1.Description = DBNull.Value.Equals(dr["Patdate"]) ? "NIL" : Convert.ToString(dr["Patdate"]);
                        //  obj1.Balance = DBNull.Value.Equals(dr["General"]) ? 0 : Convert.ToInt64(dr["General"]);
                        li.Add(obj1);
                    }
                }
                return li;
            }
        }


        public ActionResult negative()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_admissanddisdetails", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PatientDetail();
                        obj1.Count2 = DBNull.Value.Equals(dr["admistotal"]) ? 0 : Convert.ToInt64(dr["admistotal"]);
                        obj1.Count3 = DBNull.Value.Equals(dr["dischtotal"]) ? 0 : Convert.ToInt64(dr["dischtotal"]);
                        obj1.Description = DBNull.Value.Equals(dr["MonthName"]) ? "NIL" : Convert.ToString(dr["MonthName"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult ippanelcash()
        { 
         SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("select cas=(select sum(ReceivedAmount) as cash from finalbill  where PrimarypanelID=0),pan=(select sum(PanelDue) as panel from finalbill  where PrimarypanelID!=0),tot=(select sum(ReceivedAmount) as cash from finalbill  where PrimarypanelID=0) +( select sum(PanelDue) as panel from finalbill  where PrimarypanelID!=0)", con))
                {
                    //cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PatientDetail();
                        obj1.AdmissionID = DBNull.Value.Equals(dr["cas"]) ? 2 : Convert.ToInt64(dr["cas"]);
                        obj1.Count1 = DBNull.Value.Equals(dr["pan"]) ? 0 : Convert.ToInt64(dr["pan"]);
                        obj1.Count2 = DBNull.Value.Equals(dr["tot"]) ? 0 : Convert.ToInt64(dr["tot"]);
                        li.Add(obj1);
                    }
                }
            }
            return Json(li, JsonRequestBehavior.AllowGet);
                            
        }
        #endregion

        #region IPChanges

        public ActionResult IPChanges1()
        {
            ViewBag.val1 = sp_countodfregtime();
            return View();
        }

        public ActionResult sp_wardwiseinpatoutpat()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader da;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_wardwiseinpatoutpat", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    da = cmd.ExecuteReader();
                    while (da.Read())
                    {
                        obj1 = new PatientDetail();
                        obj1.AreaID = Convert.ToInt64(da["inpat"]);
                        obj1.Age = Convert.ToString(da["WardName"]);
                        obj1.AdmissionID = Convert.ToInt64(da["patdischarge"]);
                        li.Add(obj1);
                    }
                }
            }
            return Json(li, JsonRequestBehavior.AllowGet);
        }
        public ActionResult sp_todayprediction()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader da;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;
            
                using (con = new SqlConnection(cs))
                {
                    con.Open();
                    con.CreateCommand();
                    using (cmd = new SqlCommand("sp_todayprediction", con))
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        da = cmd.ExecuteReader();
                        while (da.Read())
                        {
                            obj1 = new PatientDetail();
                            obj1.AreaID = Convert.ToInt64(da["totsrd"]);
                            obj1.CategoryId = Convert.ToInt64(da["Todayadm"]);
                            obj1.AdmissionID = Convert.ToInt64(da["Totdischarge"]);
                            obj1.BloodID = Convert.ToInt64(da["TotBedFree"]);
                            li.Add(obj1);
                        }
                    }
                }
           
            return Json(li, JsonRequestBehavior.AllowGet);
        }

        public List<PatientDetail> sp_countodfregtime()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader da;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;

            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_countodfregtime", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    da = cmd.ExecuteReader();
                    while (da.Read())
                    {
                        obj1 = new PatientDetail();
                        obj1.Age = Convert.ToString(da["WardName"]);
                        obj1.AreaID = Convert.ToInt64(da["totfifpat"]);
                        obj1.AdmissionID = Convert.ToInt64(da["totthipat"]);
                        obj1.CategoryId = Convert.ToInt64(da["totforpat"]);
                        obj1.BloodID = Convert.ToInt64(da["totonehrpat"]);
                        li.Add(obj1);
                    }
                }
            }

            return li;
        }

        public ActionResult sp_countodfregtimecha()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader da;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;

            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_countodfregtime", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    da = cmd.ExecuteReader();
                    while (da.Read())
                    {
                        obj1 = new PatientDetail();
                        obj1.Age = Convert.ToString(da["WardName"]);
                        obj1.AreaID = Convert.ToInt64(da["totfifpat"]);
                        obj1.AdmissionID = Convert.ToInt64(da["totthipat"]);
                        obj1.CategoryId = Convert.ToInt64(da["totforpat"]);
                        obj1.BloodID = Convert.ToInt64(da["totonehrpat"]);
                        li.Add(obj1);
                    }
                }
            }

            return Json(li, JsonRequestBehavior.AllowGet);
        }
        #endregion


        #region Ipreturns

        public ActionResult Ipreturn()
        {
            return View();
        }
        #endregion

        #region Ip
        public ActionResult IP()
        {
            week();
            day();
            month();
            DischargePatientbyweek();
            DischargePatientbyday();
            DischargePatientbymonth();
            ViewBag.val1 = ipdaywise();
            ViewBag.val2 = CashorPanelPatient();
            ViewBag.val3 = ForeignornonforeignPatient();
            return View();
        }
        public ActionResult OPDashboard()
        {
            // PatientDetail obj = new PatientDetail();

            return View();
        }
        public Dictionary<string, int> ipdaywise()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader da;
            //var patent = new { nopatient = 0 };
            Dictionary<string, int> patent = new Dictionary<string, int>();
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_dailypatientdetail", con))
                //using (cmd = new SqlCommand("select count(InPatientNo) as no_patient,count(AdmissionID) as adds from Admission where CONVERT(VARCHAR, DateOfAdmission , 120)  like  ltrim('' + '2015-10-01' + '%')", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    da = cmd.ExecuteReader();
                    while (da.Read())
                    {
                        patent.Add(
                            DBNull.Value.Equals(da["IP"]) ? "" : Convert.ToString(da["IP"]),
                            DBNull.Value.Equals(da["Total_pat"]) ? 0 : Convert.ToInt32(da["Total_pat"])
                        );

                    }
                }

            }
            return patent;
        }


-----------------------------------------------
above

<tbody>
                            @foreach (var item1 in ViewBag.val1 as Dictionary<string, int>)
                            {
                                i++;
                                if (i < 7)
                                {
                                <tr>
                                    <td style="white-space: nowrap">
                                        @item1.Key
                                    </td>
                                    <td>
                                        @item1.Value
                                    </td>
                                </tr>
                                }
                                else
                                {

                                }
                            }
                        </tbody>

--------------------------------------------


        public ActionResult ipop()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader da;
            var ward = new[] { new { totpatient = "", notdeppatient = 0 } }.ToList();
            Dictionary<string, int> patent = new Dictionary<string, int>();
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_dailypatientdetail", con))
                //using (cmd = new SqlCommand("select count(InPatientNo) as no_patient,count(AdmissionID) as adds from Admission where CONVERT(VARCHAR, DateOfAdmission , 120)  like  ltrim('' + '2015-10-01' + '%')", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    da = cmd.ExecuteReader();
                    while (da.Read())
                    {
                        ward.Add(new
                            {
                                totpatient = DBNull.Value.Equals(da["IP"]) ? "" : Convert.ToString(da["IP"]),
                                notdeppatient = DBNull.Value.Equals(da["Total_pat"]) ? 0 : Convert.ToInt32(da["Total_pat"]),
                            });
                    }
                }

            }
            return Json(ward, JsonRequestBehavior.AllowGet);
        }




        public ActionResult wardwiseee(string fromdate, string todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader da;
            var ward = new[] { new { totpatient = 0, notdeppatient = "" } }.ToList();
            Dictionary<string, int> patent = new Dictionary<string, int>();
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                //using (cmd = new SqlCommand("sp_dailypatientdetail", con))
                using (cmd = new SqlCommand("sp_wardwisetotpatientdash", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.AddWithValue("@fromdate", fromdate);
                    cmd.Parameters.AddWithValue("@todate", todate);
                    //cmd.CommandType = CommandType.StoredProcedure;
                    da = cmd.ExecuteReader();
                    while (da.Read())
                    {
                        ward.Add(new
                        {
                            totpatient = DBNull.Value.Equals(da["no"]) ? 0 : Convert.ToInt32(da["no"]),
                            notdeppatient = DBNull.Value.Equals(da["WardName"]) ? "" : Convert.ToString(da["WardName"]),
                        });
                    }
                }

            }
            return Json(ward, JsonRequestBehavior.AllowGet);
        }

---------------------------------------------------------------------
above


$.ajax({
            url: "../Dashboard/wardwiseee",
            type: 'POST',
            data: {fromdate:fromdateconv(ID),todate:fromdateconv(ID2)},
             
            success: function (result) {
      
            $.each(result,function(ui,item){
             if (item.totpatient !="") {
                ress12.push(item.totpatient);
                ress22.push(item.notdeppatient);
                }
                
                });
--------------------------------------------------




        public ActionResult ipmonthwiseward()
        {
            var ward = new[] { new { wardname = "", patient = 0, mont = 0 } }.ToList();
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();

                using (cmd = new SqlCommand("select b.WardName,count(DATEPART(mm,a.DateOfAdmission)) as person,DATEPART(mm,a.DateOfAdmission) as date from Admission a inner join Ward b on a.WardID=b.WardId   where DATEPART(YYYY,a.DateOfAdmission)='2015' group by b.WardName,DATEPART(mm,a.DateOfAdmission)", con))
                {
                    dr = cmd.ExecuteReader();


                    while (dr.Read())
                    {
                        ward.Add(new
                        {
                            wardname = DBNull.Value.Equals(dr[""]) ? "" : Convert.ToString(dr[""]),
                            patient = DBNull.Value.Equals(dr[""]) ? 0 : Convert.ToInt32(dr[""]),
                            mont = DBNull.Value.Equals(dr[""]) ? 0 : Convert.ToInt32(dr[""]),
                        });
                    }
                }
                return Json(ward, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult DepositWisePatient(string fromdate, string todate)
        {
            var ward = new { totpatient = 0, notdeppatient = 0, deppat = 0 };
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();

                using (cmd = new SqlCommand("sp_DepositWisePatient", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.AddWithValue("@fromedate", fromdate);
                    cmd.Parameters.AddWithValue("@todate", todate);
                    dr = cmd.ExecuteReader();

                    while (dr.Read())
                    {
                        ward = new
                        {
                            totpatient = DBNull.Value.Equals(dr["TotalPatient"]) ? 0 : Convert.ToInt32(dr["TotalPatient"]),
                            notdeppatient = DBNull.Value.Equals(dr["NotDepositPatient"]) ? 0 : Convert.ToInt32(dr["NotDepositPatient"]),
                            deppat = DBNull.Value.Equals(dr["DepositPatient"]) ? 0 : Convert.ToInt32(dr["DepositPatient"]),
                        };
                    }
                }
                return Json(ward, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult PanelClaimwusePatient(string fromdate, string todate)
        {
            var ward = new { totpatient = 0, notdeppatient = 0, deppat = 0 };
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();

                using (cmd = new SqlCommand("sp_PanelClaimwusePatient", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.AddWithValue("@fromedate", fromdate);
                    cmd.Parameters.AddWithValue("@todate", todate);
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        ward = new
                        {
                            totpatient = DBNull.Value.Equals(dr["TotalPatient"]) ? 0 : Convert.ToInt32(dr["TotalPatient"]),
                            notdeppatient = DBNull.Value.Equals(dr["notclimreceiptPatient"]) ? 0 : Convert.ToInt32(dr["notclimreceiptPatient"]),
                            deppat = DBNull.Value.Equals(dr["ClaimReceiptPatient"]) ? 0 : Convert.ToInt32(dr["ClaimReceiptPatient"]),
                        };
                    }
                }
                return Json(ward, JsonRequestBehavior.AllowGet);
            }
        }
        public Dictionary<string, int> CashorPanelPatient()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader da;
            //var patent = new { nopatient = 0 };
            Dictionary<string, int> patent1 = new Dictionary<string, int>();
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                //using (cmd=new SqlCommand("sp_dailypatientdetail",con))
                using (cmd = new SqlCommand("sp_CashorPanelPatient", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    da = cmd.ExecuteReader();
                    while (da.Read())
                    {
                        patent1.Add(
                            DBNull.Value.Equals(da["PanelPatient"]) ? "" : Convert.ToString(da["PanelPatient"]),
                            DBNull.Value.Equals(da["CashPatient"]) ? 0 : Convert.ToInt32(da["CashPatient"])
                        );

                    }
                }

            }
            Session["patent1"] = patent1;
            return patent1;
        }
        public Dictionary<string, int> ForeignornonforeignPatient()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader da;
            //var patent = new { nopatient = 0 };
            Dictionary<string, int> patent1 = new Dictionary<string, int>();
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                //using (cmd=new SqlCommand("sp_dailypatientdetail",con))
                using (cmd = new SqlCommand("sp_ForeignornonforeignPatient", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    da = cmd.ExecuteReader();
                    while (da.Read())
                    {
                        patent1.Add(
                            DBNull.Value.Equals(da["nonforeignPatients"]) ? "" : Convert.ToString(da["nonforeignPatients"]),
                            DBNull.Value.Equals(da["foreignPatients"]) ? 0 : Convert.ToInt32(da["foreignPatients"])
                        );

                    }
                }

            }
            return patent1;
        }
        public ActionResult wardwise(string fromdate, string todate)
        {
            var ward = new { pat = 0 };
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_wardwisepatientdash", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.AddWithValue("@fromdate", fromdate);
                    cmd.Parameters.AddWithValue("@todate", todate);
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        ward = new
                        {
                            pat = DBNull.Value.Equals(dr["totpat"]) ? 0 : Convert.ToInt32(dr["totpat"]),
                        };
                    }

                }
            }
            return Json(ward, JsonRequestBehavior.AllowGet);
        }


        public ActionResult Datewisepattotcount()
        {

            // List<string,int>
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_totalinpatcount", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PatientDetail();
                        //    obj1.WardName = Convert.ToString(dr["WardName"]);
                        obj1.AdmissionID = DBNull.Value.Equals(dr["daypat"]) ? 0 : Convert.ToInt64(dr["daypat"]);
                        obj1.AreaID = DBNull.Value.Equals(dr["Monpat"]) ? 0 : Convert.ToInt64(dr["Monpat"]);
                        obj1.BloodID = DBNull.Value.Equals(dr["yearpat"]) ? 0 : Convert.ToInt64(dr["yearpat"]);

                        obj1.Count1 = DBNull.Value.Equals(dr["lesonedaycount"]) ? 0 : Convert.ToInt64(dr["lesonedaycount"]);  //day1cnt
                        obj1.AgeGender = DBNull.Value.Equals(dr["lesonedate"]) ? "NIL" : Convert.ToString(dr["lesonedate"]);
                        obj1.Count2 = DBNull.Value.Equals(dr["lestwodaycount"]) ? 0 : Convert.ToInt64(dr["lestwodaycount"]);  //day2cnt
                        obj1.AreaName = DBNull.Value.Equals(dr["lestwodate"]) ? "NIL" : Convert.ToString(dr["lestwodate"]);
                        obj1.Count3 = DBNull.Value.Equals(dr["lesthreeedaycount"]) ? 0 : Convert.ToInt64(dr["lesthreeedaycount"]);  //day3cnt
                        obj1.BaseEntityName = DBNull.Value.Equals(dr["lesthreedate"]) ? "NIL" : Convert.ToString(dr["lesthreedate"]);
                        obj1.Count4 = DBNull.Value.Equals(dr["lessoneMonpat"]) ? 0 : Convert.ToInt64(dr["lessoneMonpat"]);  //mon1cnt
                        obj1.BloodName = DBNull.Value.Equals(dr["lessonemon"]) ? "NIL" : Convert.ToString(dr["lessonemon"]);
                        obj1.Count5 = DBNull.Value.Equals(dr["lesstwoMonpat"]) ? 0 : Convert.ToInt64(dr["lesstwoMonpat"]);  //mon2cnt
                        obj1.Category = DBNull.Value.Equals(dr["lesstwomon"]) ? "NIL" : Convert.ToString(dr["lesstwomon"]);
                        obj1.Count6 = DBNull.Value.Equals(dr["lessthreeeMonpat"]) ? 0 : Convert.ToInt64(dr["lessthreeeMonpat"]);  //mon3cnt
                        obj1.categoryname = DBNull.Value.Equals(dr["lessthreemon"]) ? "NIL" : Convert.ToString(dr["lessthreemon"]);

                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }

        }

        public ActionResult bedwisename(string fromdate, string todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_wardwisebedpatientdash", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.AddWithValue("@fromdate", fromdate);
                    cmd.Parameters.AddWithValue("@todate", todate);
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PatientDetail();
                        obj1.AgeGender = DBNull.Value.Equals(dr["Wardname"]) ? "NIL" : Convert.ToString(dr["Wardname"]);
                        obj1.MotherOccupationID = DBNull.Value.Equals(dr["total"]) ? 0 : Convert.ToInt32(dr["total"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }

        }


        public ActionResult bedwisename1(string id, string from, string to)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PatientDetail> li = new List<PatientDetail>();
            PatientDetail obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                //using (cmd = new SqlCommand("select count(a.patientid) as cou from BedStatus_V a where a.DateOfAdmission between @fromdate and @todate and a.Wardname=@id", con))
                using (cmd = new SqlCommand("bedwisepardash", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.AddWithValue("@surgward", id);
                    cmd.Parameters.AddWithValue("@fromdate", from);
                    cmd.Parameters.AddWithValue("@todate", to);
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PatientDetail();
                        //obj1.AgeGender = DBNull.Value.Equals(dr["CategoryName"]) ? "NIL" : Convert.ToString(dr["CategoryName"]);
                        obj1.MotherOccupationID = DBNull.Value.Equals(dr["cou"]) ? 0 : Convert.ToInt32(dr["cou"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }

        }
        #endregion

        #region  Category
        #region All Sub Category


        public ActionResult initial()
        {
            HealthCareInMvc4.RoleProfileServiceRef.RoleProfile objuser = new HealthCareInMvc4.RoleProfileServiceRef.RoleProfile();
            objuser = (HealthCareInMvc4.RoleProfileServiceRef.RoleProfile)Session["UserList"];
            Int64 UserID = objuser.UserID;
            Session["userid"] = UserID;

            Int64 ClientID = objuser.ClientID;
            Session["clientid"] = ClientID;
            MainStoreSubStoreServiceClient objresult = new MainStoreSubStoreServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "MainStoreSubStoreService.svc")));
            var list = objresult.MainStoreListByModuleID(5, Convert.ToString(ClientID), UserID);
            //ViewBag.list = new SelectList(list.AsEnumerable(), "MainStoreID", "MainStoreName", list.FirstOrDefault().MainStoreID);

            //IndentRequestServiceClient indentlist = new IndentRequestServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "IndentRequestService.svc")));
            //var sublist = indentlist.ListSubstore(5, 1, ClientID, UserID);
            //ViewBag.sublist = new SelectList(sublist.AsEnumerable(), "SubStoreID", "SubStoreName", sublist.FirstOrDefault().SubStoreID);

            ChartViewModel _ChartViewModel = new ChartViewModel();
            _ChartViewModel.SalesOrderProduct = substore1();
            _ChartViewModel.SalesOrderDayWise = daywisesubstpro();



            return View(_ChartViewModel);
        }

        //public ActionResult initialSales()
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<PurchaseOrder> li = new List<PurchaseOrder>();
        //    PurchaseOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("sp_salesinitial", con))
        //        {
        //            cmd.CommandType = CommandType.StoredProcedure;
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new PurchaseOrder();
        //                obj1.SubStoreName = Convert.ToString(dr["SubStoreName"]);
        //                obj1.InvoiceSubTotal = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? 0 : Convert.ToInt64(dr["InvoiceSubTotal"]);
        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }

        //}

        //public ActionResult initialIncome()
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<PurchaseOrder> li = new List<PurchaseOrder>();
        //    PurchaseOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("sp_incomeinitial", con))
        //        {
        //            cmd.CommandType = CommandType.StoredProcedure;
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new PurchaseOrder();
        //                obj1.IPsales = DBNull.Value.Equals(dr["IPsales"]) ? 0 : Convert.ToInt64(dr["IPsales"]);
        //                obj1.Opsales = DBNull.Value.Equals(dr["Opsales"]) ? 0 : Convert.ToInt64(dr["Opsales"]);
        //                obj1.Doctorsales = DBNull.Value.Equals(dr["Doctorsales"]) ? 0 : Convert.ToInt64(dr["Doctorsales"]);
        //                obj1.Genralsales = DBNull.Value.Equals(dr["Genralsales"]) ? 0 : Convert.ToInt64(dr["Genralsales"]);
        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }

        //}

        //public ActionResult initialTosalesProduct()
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<PurchaseOrder> li = new List<PurchaseOrder>();
        //    PurchaseOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("Sp_TopsalesProductdash", con))
        //        {
        //            cmd.CommandType = CommandType.StoredProcedure;
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new PurchaseOrder();
        //                obj1.NAME = Convert.ToString(dr["NAME"]);
        //                obj1.TotalCOunt = DBNull.Value.Equals(dr["TotalCOunt"]) ? 0 : Convert.ToInt64(dr["TotalCOunt"]); //Convert.ToInt64(dr["SubTotal"]);

        //                //    obj1.value8 = DBNull.Value.Equals(dr["total"]) ? 0 : Convert.ToInt64(dr["total"]); // Convert.ToInt16(dr["ClosedFlag"]);

        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }
        //}


        public ActionResult Index()
        {
            return View();
        }
        public ActionResult MenuNamepartialview()
        {
            return View();
        }
        public ActionResult ADDNEWPARTIALVIEW()
        {
            HealthCareInMvc4.RoleProfileServiceRef.RoleProfile objuser = new HealthCareInMvc4.RoleProfileServiceRef.RoleProfile();
            objuser = (HealthCareInMvc4.RoleProfileServiceRef.RoleProfile)Session["UserList"];
            Int64 UserID = objuser.UserID;
            Session["userid"] = UserID;

            Int64 ClientID = objuser.ClientID;
            Session["clientid"] = ClientID;
            MainStoreSubStoreServiceClient objresult = new MainStoreSubStoreServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "MainStoreSubStoreService.svc")));
            var list = objresult.MainStoreListByModuleID(5, Convert.ToString(ClientID), UserID);
            ViewBag.list = new SelectList(list.AsEnumerable(), "MainStoreID", "MainStoreName", list.FirstOrDefault().MainStoreID);

            IndentRequestServiceClient indentlist = new IndentRequestServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "IndentRequestService.svc")));
            var sublist = indentlist.ListSubstore(5, 1, ClientID, UserID);
            ViewBag.sublist = new SelectList(sublist.AsEnumerable(), "SubStoreID", "SubStoreName", sublist.FirstOrDefault().SubStoreID);

            return View();
        }
        public ActionResult Gridpartialview()
        {
            //var d1=
            //return Json(new{data1=d1,data2=d2}
            //)
            return View();
        }

        public ActionResult Purchase(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_Purchase", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.POAprroved = DBNull.Value.Equals(dr["POAprroved"]) ? 0 : Convert.ToInt64(dr["POAprroved"]); //Convert.ToInt64(dr["SubTotal"]);
                        obj1.PORejected = DBNull.Value.Equals(dr["PORejected"]) ? 0 : Convert.ToInt64(dr["PORejected"]); // Convert.ToString(dr["PORejected"]);
                        obj1.POPending = DBNull.Value.Equals(dr["POPending"]) ? 0 : Convert.ToInt64(dr["POPending"]);// Convert.ToString(dr["POPending"]);

                        //    obj1.value8 = DBNull.Value.Equals(dr["total"]) ? 0 : Convert.ToInt64(dr["total"]); // Convert.ToInt16(dr["ClosedFlag"]);

                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }

        public ActionResult TosalesProduct(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("Sp_TopsalesProduct", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.NAME = Convert.ToString(dr["NAME"]);
                        obj1.TotalCOunt = DBNull.Value.Equals(dr["TotalCOunt"]) ? 0 : Convert.ToInt64(dr["TotalCOunt"]); //Convert.ToInt64(dr["SubTotal"]);

                        //    obj1.value8 = DBNull.Value.Equals(dr["total"]) ? 0 : Convert.ToInt64(dr["total"]); // Convert.ToInt16(dr["ClosedFlag"]);

                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }




        //public ActionResult PurchaseReturn(string Fromdate, string Todate)
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<PurchaseOrder> li = new List<PurchaseOrder>();
        //    PurchaseOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("sp_Purchasreturn", con))
        //        {
        //            cmd.CommandType = CommandType.StoredProcedure;
        //            cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
        //            cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new PurchaseOrder();
        //                obj1.SubTotal = DBNull.Value.Equals(dr["Totalamountofpurreturn"]) ? 0 : Convert.ToInt64(dr["Totalamountofpurreturn"]); //Convert.ToInt64(dr["Totalamountofpurreturn"]);                       
        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }
        //}


        public ActionResult GRN(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_grn", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.NAME = Convert.ToString(dr["NAME"]);
                        obj1.TotalGrnRecieved = DBNull.Value.Equals(dr["TotalGrnRecieved"]) ? 0 : Convert.ToInt64(dr["TotalGrnRecieved"]);  // Convert.ToInt64(dr["SubTotal"]);
                        obj1.Subtotal = DBNull.Value.Equals(dr["Subtotal"]) ? 0 : Convert.ToInt64(dr["Subtotal"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }

        public ActionResult topboughtproducts(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_topboughtproducts", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.Productname = Convert.ToString(dr["Productname"]);
                        obj1.TotalCOunt = DBNull.Value.Equals(dr["Totalcount"]) ? 0 : Convert.ToInt64(dr["Totalcount"]);  // Convert.ToInt64(dr["SubTotal"]);
                        // obj1.Subtotal = DBNull.Value.Equals(dr["Subtotal"]) ? 0 : Convert.ToInt64(dr["Subtotal"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }





        //public ActionResult poclosed(String Fromdate, String Todate)
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<PurchaseOrder> li = new List<PurchaseOrder>();
        //    PurchaseOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("sp_poclosed", con))
        //        {
        //            cmd.CommandType = CommandType.StoredProcedure;
        //            cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
        //            cmd.Parameters.Add(new SqlParameter("@todate", Todate));
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new PurchaseOrder();
        //                obj1.VendorName = Convert.ToString(dr["VendorName"]);
        //                obj1.TotalPOCLosed = DBNull.Value.Equals(dr["TotalPOCLosed"]) ? 0 : Convert.ToInt64(dr["TotalPOCLosed"]); // Convert.ToInt64(dr["total"]);
        //                obj1.Subtotal = DBNull.Value.Equals(dr["Subtotal"]) ? 0 : Convert.ToInt64(dr["Subtotal"]); //Convert.ToInt64(dr["val"]);
        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }
        //}



        public ActionResult Loss(String Fromdate, String Todate)
        {
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr = null;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("Sp_BrokenandExpiredtotal_JRP", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.AddWithValue("@FromDate", Fromdate);
                    cmd.Parameters.AddWithValue("@ToDate", Todate);
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.NAME = Convert.ToString(dr["NAME"]);
                        obj1.TotalExpenses = DBNull.Value.Equals(dr["TotalExpenses"]) ? 0 : Convert.ToInt64(dr["TotalExpenses"]);
                        li.Add(obj1);
                    }
                }

                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }

        public ActionResult Sales(String Fromdate, String Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_sales", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@todate", Todate));
                    // cmd.Parameters.Add(new SqlParameter("@value", value));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.SubStoreName = Convert.ToString(dr["SubStoreName"]);
                        // obj1.IPsales = DBNull.Value.Equals(dr["IPsales"]) ? 0 : Convert.ToInt64(dr["IPsales"]);
                        //obj1.Opsales = DBNull.Value.Equals(dr["Opsales"]) ? 0 : Convert.ToInt64(dr["Opsales"]);
                        // obj1.Doctorsales = DBNull.Value.Equals(dr["Doctorsales"]) ? 0 : Convert.ToInt64(dr["Doctorsales"]);
                        obj1.InvoiceSubTotal = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? 0 : Convert.ToInt64(dr["InvoiceSubTotal"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }

        }

        public ActionResult Indentrequest(String Fromdate, String Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_indentrequest", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@todate", Todate));
                    // cmd.Parameters.Add(new SqlParameter("@value", value));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.SubStoreName = Convert.ToString(dr["SubStoreName"]);
                        obj1.TotalRequest = DBNull.Value.Equals(dr["TotalRequest"]) ? 0 : Convert.ToInt64(dr["TotalRequest"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }

        }

        //public ActionResult Income(String Fromdate, String Todate)
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<PurchaseOrder> li = new List<PurchaseOrder>();
        //    PurchaseOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("sp_income", con))
        //        {
        //            cmd.CommandType = CommandType.StoredProcedure;
        //            cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
        //            cmd.Parameters.Add(new SqlParameter("@todate", Todate));
        //            //  cmd.Parameters.Add(new SqlParameter("@value", value));
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new PurchaseOrder();
        //                obj1.LocationID = DBNull.Value.Equals(dr["total"]) ? 0 : Convert.ToInt64(dr["total"]);
        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }

        //}

        public ActionResult Income(String Fromdate, String Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_income", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@todate", Todate));
                    // cmd.Parameters.Add(new SqlParameter("@value", value));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.IPsales = DBNull.Value.Equals(dr["IPsales"]) ? 0 : Convert.ToInt64(dr["IPsales"]);
                        obj1.Opsales = DBNull.Value.Equals(dr["Opsales"]) ? 0 : Convert.ToInt64(dr["Opsales"]);
                        obj1.Doctorsales = DBNull.Value.Equals(dr["Doctorsales"]) ? 0 : Convert.ToInt64(dr["Doctorsales"]);
                        obj1.Genralsales = DBNull.Value.Equals(dr["Genralsales"]) ? 0 : Convert.ToInt64(dr["Genralsales"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }

        }


        #endregion

        #region dashboard Ado.net

        #region Default Dashboard
        public List<SalesOrder> substore1()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_storesales", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        obj1.BaseEntityName = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? "" : Convert.ToString(dr["SubStoreName"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? 0.0m : Convert.ToDecimal(dr["InvoiceSubTotal"]);
                        obj.Add(obj1);

                    }
                }
            }
            return obj;
        }




        public ActionResult substore2()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_storesales", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;

                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.BillingState = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? "" : Convert.ToString(dr["SubStoreName"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? 0.0m : Convert.ToDecimal(dr["InvoiceSubTotal"]);


                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }

        public ActionResult daysubstore()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("Sp_Datewisesale", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;

                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {

                        obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["Date1"]) ? "" : Convert.ToString(dr["Date1"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["Total"]) ? 0.0m : Convert.ToDecimal(dr["Total"]);


                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }

        public ActionResult yearsubstore()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_yearwisesales", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;

                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {

                        obj1 = new SalesOrder();

                        obj1.BillAmount = DBNull.Value.Equals(dr["Totalsales"]) ? 0.0m : Convert.ToDecimal(dr["Totalsales"]);
                        obj1.InvoiceBalance = DBNull.Value.Equals(dr["TotalPO"]) ? 0.0m : Convert.ToDecimal(dr["TotalPO"]);


                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public List<SalesOrder> daywisesubstpro()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("Sp_TopsoldProductdatewise", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;

                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        string dat;
                        obj1 = new SalesOrder();
                        obj1.Bankid = DBNull.Value.Equals(dr["NAME"]) ? "" : Convert.ToString(dr["NAME"]);
                        obj1.Clientname = DBNull.Value.Equals(dr["SubStoreName"]) ? "" : Convert.ToString(dr["SubStoreName"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["Total"]) ? 0.0m : Convert.ToDecimal(dr["Total"]);
                        dat = DBNull.Value.Equals(dr["Salesdate"]) ? "" : Convert.ToString(dr["Salesdate"]);
                        if (dat == "")
                        {
                            obj1.Age = dat;
                        }
                        else
                        {
                            string[] arrDate = dat.Split('-');
                            string day = arrDate[2].ToString();
                            string month = arrDate[1].ToString();
                            string year = arrDate[0].ToString();
                            obj1.Age = day + "-" + month + "-" + year;
                        }
                        li.Add(obj1);
                    }
                }
                return li;
            }
        }






        #endregion

        #region sales Dashboard

        #endregion

        #region Purchase Dashboard

        #endregion

        #endregion

        #region All partial view for dashboard


        public PartialViewResult _VendorWise()
        {
            return PartialView();
        }


        #endregion

        #endregion

        //.......PatientCategory.......//
        #region PatientCategory

        public ActionResult PatientCategory()
        {
            HealthCareInMvc4.RoleProfileServiceRef.RoleProfile objuser = new HealthCareInMvc4.RoleProfileServiceRef.RoleProfile();
            objuser = (HealthCareInMvc4.RoleProfileServiceRef.RoleProfile)Session["UserList"];
            Int64 UserID = objuser.UserID;
            Session["userid"] = UserID;

            Int64 ClientID = objuser.ClientID;
            Session["clientid"] = ClientID;
            MainStoreSubStoreServiceClient objresult = new MainStoreSubStoreServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "MainStoreSubStoreService.svc")));
            var list = objresult.MainStoreListByModuleID(5, Convert.ToString(ClientID), UserID);
            ViewBag.list = new SelectList(list.AsEnumerable(), "MainStoreID", "MainStoreName", list.FirstOrDefault().MainStoreID);

            //IndentRequestServiceClient indentlist = new IndentRequestServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "IndentRequestService.svc")));
            //var sublist = indentlist.ListSubstore(5, 1, ClientID, UserID);
            //ViewBag.sublist = new SelectList(sublist.AsEnumerable(), "SubStoreID", "SubStoreName", sublist.FirstOrDefault().SubStoreID);

            ChartViewModel _ChartViewModel = new ChartViewModel();
            _ChartViewModel.paitents1 = paitents11();
            _ChartViewModel.paitents2 = paitents12();
            return View(_ChartViewModel);
        }
        public ActionResult Paitentcatagory(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_Paitentcatagory", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@todate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.Amount = DBNull.Value.Equals(dr["Ip"]) ? 0 : Convert.ToInt64(dr["ip"]);
                        obj1.AmountPaid = DBNull.Value.Equals(dr["OP"]) ? 0 : Convert.ToInt64(dr["OP"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["Do"]) ? 0 : Convert.ToInt64(dr["Do"]);
                        obj1.Balance = DBNull.Value.Equals(dr["General"]) ? 0 : Convert.ToInt64(dr["General"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Paitentcatagory1(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("Paitentcatagory1", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@todate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();

                        obj1.Amount = DBNull.Value.Equals(dr["Ip"]) ? 0 : Convert.ToInt64(dr["ip"]);
                        obj1.AmountPaid = DBNull.Value.Equals(dr["OP"]) ? 0 : Convert.ToInt64(dr["OP"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["Do"]) ? 0 : Convert.ToInt64(dr["Do"]);
                        obj1.Balance = DBNull.Value.Equals(dr["General"]) ? 0 : Convert.ToInt64(dr["General"]);
                        obj1.Barcode1 = DBNull.Value.Equals(dr["Ip1"]) ? 0 : Convert.ToInt64(dr["ip1"]);
                        obj1.ClientID = DBNull.Value.Equals(dr["OP1"]) ? 0 : Convert.ToInt64(dr["OP1"]);
                        obj1.ClientId1 = DBNull.Value.Equals(dr["Do1"]) ? 0 : Convert.ToInt64(dr["Do1"]);
                        obj1.CustomerID = DBNull.Value.Equals(dr["General1"]) ? 0 : Convert.ToInt16(dr["General1"]);
                        obj1.Clientname = DBNull.Value.Equals(dr["datee"]) ? "" : Convert.ToString(dr["datee"]);
                        obj1.Date = DBNull.Value.Equals(dr["datee1"]) ? "" : Convert.ToString(dr["datee1"]);
                        //     obj1.rate
                        obj1.Ip2 = DBNull.Value.Equals(dr["Ip2"]) ? 0 : Convert.ToInt64(dr["ip2"]);
                        obj1.Op2 = DBNull.Value.Equals(dr["OP2"]) ? 0 : Convert.ToInt64(dr["OP2"]);
                        obj1.Do2 = DBNull.Value.Equals(dr["Do2"]) ? 0 : Convert.ToInt64(dr["Do2"]);
                        obj1.General2 = DBNull.Value.Equals(dr["General2"]) ? 0 : Convert.ToInt64(dr["General2"]);
                        obj1.Ipp = DBNull.Value.Equals(dr["Ip3"]) ? 0 : Convert.ToInt64(dr["ip3"]);
                        obj1.Opp = DBNull.Value.Equals(dr["OP3"]) ? 0 : Convert.ToInt64(dr["OP3"]);
                        obj1.Do3 = DBNull.Value.Equals(dr["Do3"]) ? 0 : Convert.ToInt64(dr["Do3"]);
                        obj1.General3 = DBNull.Value.Equals(dr["General3"]) ? 0 : Convert.ToInt64(dr["General3"]);
                        obj1.Custom1 = DBNull.Value.Equals(dr["datee2"]) ? "" : Convert.ToString(dr["datee2"]);
                        obj1.Custom2 = DBNull.Value.Equals(dr["datee3"]) ? "" : Convert.ToString(dr["datee3"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Paitentcatag1()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_salescategory", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.Amount = DBNull.Value.Equals(dr["Ip"]) ? 0 : Convert.ToInt64(dr["ip"]);
                        obj1.AmountPaid = DBNull.Value.Equals(dr["OP"]) ? 0 : Convert.ToInt64(dr["OP"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["Do"]) ? 0 : Convert.ToInt64(dr["Do"]);
                        obj1.Balance = DBNull.Value.Equals(dr["General"]) ? 0 : Convert.ToInt64(dr["General"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Paitentcatag2()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_Paitentcatag", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();

                        obj1.Amount = DBNull.Value.Equals(dr["Ip"]) ? 0 : Convert.ToInt64(dr["ip"]);
                        obj1.AmountPaid = DBNull.Value.Equals(dr["OP"]) ? 0 : Convert.ToInt64(dr["OP"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["Do"]) ? 0 : Convert.ToInt64(dr["Do"]);
                        obj1.Balance = DBNull.Value.Equals(dr["General"]) ? 0 : Convert.ToInt64(dr["General"]);
                        obj1.Barcode1 = DBNull.Value.Equals(dr["Ip1"]) ? 0 : Convert.ToInt64(dr["ip1"]);
                        obj1.ClientID = DBNull.Value.Equals(dr["OP1"]) ? 0 : Convert.ToInt64(dr["OP1"]);
                        obj1.ClientId1 = DBNull.Value.Equals(dr["Do1"]) ? 0 : Convert.ToInt64(dr["Do1"]);
                        obj1.CustomerID = DBNull.Value.Equals(dr["General1"]) ? 0 : Convert.ToInt16(dr["General1"]);
                        obj1.Date = DBNull.Value.Equals(dr["date1"]) ? "" : Convert.ToString(dr["date1"]);
                        obj1.Custom1 = DBNull.Value.Equals(dr["date2"]) ? "" : Convert.ToString(dr["date2"]);
                        obj1.Custom2 = DBNull.Value.Equals(dr["date3"]) ? "" : Convert.ToString(dr["date3"]);
                        obj1.Custom4 = DBNull.Value.Equals(dr["date4"]) ? "" : Convert.ToString(dr["date4"]);

                        obj1.Ip2 = DBNull.Value.Equals(dr["Ip2"]) ? 0 : Convert.ToInt64(dr["ip2"]);
                        obj1.Op2 = DBNull.Value.Equals(dr["OP2"]) ? 0 : Convert.ToInt64(dr["OP2"]);
                        obj1.Do2 = DBNull.Value.Equals(dr["Do2"]) ? 0 : Convert.ToInt64(dr["Do2"]);
                        obj1.General2 = DBNull.Value.Equals(dr["General2"]) ? 0 : Convert.ToInt64(dr["General2"]);
                        obj1.Ipp = DBNull.Value.Equals(dr["Ip3"]) ? 0 : Convert.ToInt64(dr["ip3"]);
                        obj1.Opp = DBNull.Value.Equals(dr["OP3"]) ? 0 : Convert.ToInt64(dr["OP3"]);
                        obj1.Do3 = DBNull.Value.Equals(dr["Do3"]) ? 0 : Convert.ToInt64(dr["Do3"]);
                        obj1.General3 = DBNull.Value.Equals(dr["General3"]) ? 0 : Convert.ToInt64(dr["General3"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }

        public List<SalesOrder> paitents11()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                //using (cmd = new SqlCommand("select (select count(CustomerCategory) as CustomerCategory  from SO_SalesOrder where CreatedDate between  convert(datetime, '2015-06-16 08:25:46.693',102) and convert(datetime,'2015-06-16 13:50:11.970',102) and CustomerCategory=0) as Ip,(select count(CustomerCategory) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =0 and CreatedDate between  convert(datetime, '2015-06-16 08:25:46.693',102) and convert(datetime,'2015-06-16 13:50:11.970',102)) as OP,(select count(CustomerCategory) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =2 and CreatedDate between  convert(datetime, '2015-06-16 08:25:46.693',102) and convert(datetime,'2015-06-16 13:50:11.970',102)) as Do,(select count(CustomerCategory) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =3 and CreatedDate between  convert(datetime, '2015-06-16 08:25:46.693',102) and convert(datetime,'2015-06-16 13:50:11.970',102)) as General", conn))
                using (cmd = new SqlCommand("sp_salesordet1", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        obj1.Amount = DBNull.Value.Equals(dr["ip"]) ? 0 : Convert.ToInt64(dr["ip"]);
                        obj1.AmountPaid = DBNull.Value.Equals(dr["OP"]) ? 0 : Convert.ToInt64(dr["OP"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["Do"]) ? 0 : Convert.ToInt64(dr["Do"]);
                        obj1.Balance = DBNull.Value.Equals(dr["General"]) ? 0 : Convert.ToInt64(dr["General"]);
                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }
        public List<SalesOrder> paitents12()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            //var from = "2015-06-16";
            //var to = "2015-06-30";

            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                //                using (cmd = new SqlCommand("select (select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where CreatedDate between  convert(datetime, @fromdate,102) and convert(datetime,@todate,102) and CustomerCategory=0) as Ip,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =0 and CreatedDate between  convert(datetime, @fromdate,102) and convert(datetime,@todate,102)) as OP,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =2 and CreatedDate between  convert(datetime, @fromdate,102) and convert(datetime,@todate,102)) as Do,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =3 and CreatedDate between  convert(datetime, @fromdate,102) and convert(datetime,@todate,102)) as General,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where CreatedDate between  convert(datetime, DATEADD(day, 1, @fromdate),102) and convert(datetime,@todate,102) and CustomerCategory=0) as Ip1,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =0 and CreatedDate between  convert(datetime, DATEADD(day, 1, @fromdate),102) and convert(datetime,@todate,102)) as OP1,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =2 and CreatedDate between  convert(datetime, DATEADD(day, 1, @fromdate),102) and convert(datetime,@todate,102)) as Do1,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =3 and CreatedDate between  convert(datetime, DATEADD(day, 1, @fromdate),102) and convert(datetime,@todate,102)) as General1,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where CreatedDate between  convert(datetime, DATEADD(day, 2, @fromdate),102) and convert(datetime,@todate,102) and CustomerCategory=0) as Ip2,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =0 and CreatedDate between  convert(datetime, DATEADD(day, 2, @fromdate),102) and convert(datetime,@todate,102)) as OP2,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =2 and CreatedDate between  convert(datetime, DATEADD(day, 2, @fromdate),102) and convert(datetime,@todate,102)) as Do2,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =3 and CreatedDate between  convert(datetime, DATEADD(day, 2, @fromdate),102) and convert(datetime,@todate,102)) as General2,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where CreatedDate between  convert(datetime, DATEADD(day, 3, @fromdate),102) and convert(datetime,@todate,102) and CustomerCategory=0) as Ip3,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =0 and CreatedDate between  convert(datetime, DATEADD(day, 3, @fromdate),102) and convert(datetime,@todate,102)) as OP3,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =2 and CreatedDate between  convert(datetime, DATEADD(day, 3, @fromdate),102) and convert(datetime,@todate,102)) as Do3,(select sum(InvoiceSubTotal) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =3 and CreatedDate between  convert(datetime, DATEADD(day, 3, @fromdate),102) and convert(datetime,@todate,102)) as General3,(select @fromdate as date) as datee,(select convert(VARCHAR(10),DATEADD(day, 1, @fromdate),110)) as datee1,(select convert(VARCHAR(10),DATEADD(day, 2, @fromdate),110)) as datee2,(select convert(VARCHAR(10),DATEADD(day, 3, @fromdate),110)) as datee3", conn))
                using (cmd = new SqlCommand("sp_paitents12dsh", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    //cmd.Parameters.AddWithValue("@fromdate", from);
                    //cmd.Parameters.AddWithValue("@todate", to);
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        obj1.Amount = DBNull.Value.Equals(dr["Ip"]) ? 0 : Convert.ToInt64(dr["ip"]);
                        obj1.AmountPaid = DBNull.Value.Equals(dr["OP"]) ? 0 : Convert.ToInt64(dr["OP"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["Do"]) ? 0 : Convert.ToInt64(dr["Do"]);
                        obj1.Balance = DBNull.Value.Equals(dr["General"]) ? 0 : Convert.ToInt64(dr["General"]);
                        obj1.Barcode1 = DBNull.Value.Equals(dr["Ip1"]) ? 0 : Convert.ToInt64(dr["ip1"]);
                        obj1.ClientID = DBNull.Value.Equals(dr["OP1"]) ? 0 : Convert.ToInt64(dr["OP1"]);
                        obj1.ClientId1 = DBNull.Value.Equals(dr["Do1"]) ? 0 : Convert.ToInt64(dr["Do1"]);
                        obj1.CustomerID = DBNull.Value.Equals(dr["General1"]) ? 0 : Convert.ToInt16(dr["General1"]);
                        obj1.Clientname = DBNull.Value.Equals(dr["datee"]) ? "" : Convert.ToString(dr["datee"]);
                        obj1.Date = DBNull.Value.Equals(dr["datee1"]) ? "" : Convert.ToString(dr["datee1"]);

                        obj1.Ip2 = DBNull.Value.Equals(dr["Ip2"]) ? 0 : Convert.ToInt64(dr["ip2"]);
                        obj1.Op2 = DBNull.Value.Equals(dr["OP2"]) ? 0 : Convert.ToInt64(dr["OP2"]);
                        obj1.Do2 = DBNull.Value.Equals(dr["Do2"]) ? 0 : Convert.ToInt64(dr["Do2"]);
                        obj1.General2 = DBNull.Value.Equals(dr["General2"]) ? 0 : Convert.ToInt16(dr["General2"]);
                        obj1.Ipp = DBNull.Value.Equals(dr["Ip3"]) ? 0 : Convert.ToInt64(dr["ip3"]);
                        obj1.Opp = DBNull.Value.Equals(dr["OP3"]) ? 0 : Convert.ToInt64(dr["OP3"]);
                        obj1.Do3 = DBNull.Value.Equals(dr["Do3"]) ? 0 : Convert.ToInt64(dr["Do3"]);
                        obj1.General3 = DBNull.Value.Equals(dr["General3"]) ? 0 : Convert.ToInt16(dr["General3"]);
                        obj1.Custom1 = DBNull.Value.Equals(dr["datee2"]) ? "" : Convert.ToString(dr["datee2"]);
                        obj1.Custom2 = DBNull.Value.Equals(dr["datee3"]) ? "" : Convert.ToString(dr["datee3"]);
                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }



        #endregion


        //.........sales...........//
        #region of sales
        public ActionResult SalesCategory()
        {
            HealthCareInMvc4.RoleProfileServiceRef.RoleProfile objuser = new HealthCareInMvc4.RoleProfileServiceRef.RoleProfile();
            objuser = (HealthCareInMvc4.RoleProfileServiceRef.RoleProfile)Session["UserList"];
            Int64 UserID = objuser.UserID;
            Session["userid"] = UserID;

            Int64 ClientID = objuser.ClientID;
            Session["clientid"] = ClientID;
            MainStoreSubStoreServiceClient objresult = new MainStoreSubStoreServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "MainStoreSubStoreService.svc")));
            var list = objresult.MainStoreListByModuleID(5, Convert.ToString(ClientID), UserID);
            ViewBag.list = new SelectList(list.AsEnumerable(), "MainStoreID", "MainStoreName", list.FirstOrDefault().MainStoreID);

            //IndentRequestServiceClient indentlist = new IndentRequestServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "IndentRequestService.svc")));
            //var sublist = indentlist.ListSubstore(5, 1, ClientID, UserID);
            //ViewBag.sublist = new SelectList(sublist.AsEnumerable(), "SubStoreID", "SubStoreName", sublist.FirstOrDefault().SubStoreID);

            ChartViewModel _ChartViewModel = new ChartViewModel();
            _ChartViewModel.substores1 = substores11();
            _ChartViewModel.substores2 = substores12();
            return View(_ChartViewModel);
        }

        //.........sales...........//

        public ActionResult substoree2(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_substore222", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@todate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["Name"]) ? "" : Convert.ToString(dr["Name"]);
                        obj1.ClientID = DBNull.Value.Equals(dr["Sales"]) ? 0 : Convert.ToInt64(dr["Sales"]);
                        obj1.Amount = DBNull.Value.Equals(dr["quentity"]) ? 0 : Convert.ToInt64(dr["quentity"]);
                        obj1.Date = DBNull.Value.Equals(dr["date"]) ? "" : Convert.ToString(dr["date"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult subst3(string Fromdate, string Todate, string name)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_subst3", con))
                //using (cmd = new SqlCommand("select sub.SubStoreName,a.Quantity,a.SubTotal as price,bp.Name from SO_SalesOrderInvoice_Line a inner join  BASE_Product bp on bp.ProdID=a.ProdID inner join Base_InventorySubStores sub on sub.SubStoreID=a.SubStoreID where sub.SubStoreName='OT STORES' and a.CreatedDate   between  '2014-04-10 08:25:46.693' and '2015-09-27 13:50:11.970' ", con))
                //using (cmd = new SqlCommand("productcategorystore", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@todate", Todate));
                    cmd.Parameters.Add(new SqlParameter("@storename", name));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["SubStoreName"]) ? "" : Convert.ToString(dr["SubStoreName"]);
                        obj1.ClientID = DBNull.Value.Equals(dr["price"]) ? 0 : Convert.ToInt64(dr["price"]);
                        obj1.Amount = DBNull.Value.Equals(dr["Quantity"]) ? 0 : Convert.ToInt64(dr["Quantity"]);
                        obj1.Date = DBNull.Value.Equals(dr["Name"]) ? "" : Convert.ToString(dr["Name"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult subst311(string name)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_subst311", con))
                //using (cmd = new SqlCommand("select sub.SubStoreName,a.Quantity,a.SubTotal as price,bp.Name from SO_SalesOrderInvoice_Line a inner join  BASE_Product bp on bp.ProdID=a.ProdID inner join Base_InventorySubStores sub on sub.SubStoreID=a.SubStoreID where sub.SubStoreName='OT STORES' and a.CreatedDate   between  '2014-04-10 08:25:46.693' and '2015-09-27 13:50:11.970' ", con))
                //using (cmd = new SqlCommand("productcategorystore", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@storename", name));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["SubStoreName"]) ? "" : Convert.ToString(dr["SubStoreName"]);
                        obj1.ClientID = DBNull.Value.Equals(dr["price"]) ? 0 : Convert.ToInt64(dr["price"]);
                        obj1.Amount = DBNull.Value.Equals(dr["Quantity"]) ? 0 : Convert.ToInt64(dr["Quantity"]);
                        obj1.Date = DBNull.Value.Equals(dr["Name"]) ? "" : Convert.ToString(dr["Name"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult substoree3(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_substore33", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@todate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["Name"]) ? "" : Convert.ToString(dr["Name"]);
                        obj1.ClientID = DBNull.Value.Equals(dr["Sales"]) ? 0 : Convert.ToInt64(dr["Sales"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }


        public ActionResult substoree21()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_substore21", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["Name"]) ? "" : Convert.ToString(dr["Name"]);
                        obj1.ClientID = DBNull.Value.Equals(dr["Sales"]) ? 0 : Convert.ToInt64(dr["Sales"]);
                        obj1.Amount = DBNull.Value.Equals(dr["quentity"]) ? 0 : Convert.ToInt64(dr["quentity"]);
                        obj1.Date = DBNull.Value.Equals(dr["date"]) ? "" : Convert.ToString(dr["date"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult substoree31()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_substore31", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["Name"]) ? "" : Convert.ToString(dr["Name"]);
                        obj1.ClientID = DBNull.Value.Equals(dr["Sales"]) ? 0 : Convert.ToInt64(dr["Sales"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }







        public List<SalesOrder> substores11()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_substore45", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["SubStoreName"]) ? "" : Convert.ToString(dr["SubStoreName"]);
                        obj1.Amount = DBNull.Value.Equals(dr["InvoiceTotal"]) ? 0 : Convert.ToInt16(dr["InvoiceTotal"]);
                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }
        public List<SalesOrder> substores12()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_substore48", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["ProductTypeName"]) ? "" : Convert.ToString(dr["ProductTypeName"]);
                        //obj1.Balance = DBNull.Value.Equals(dr["SubStoreID"]) ? 0.0m : Convert.ToDecimal(dr["SubStoreID"]);
                        obj1.Amount = DBNull.Value.Equals(dr["SubTotal"]) ? 0 : Convert.ToInt16(dr["SubTotal"]);
                        obj1.AmountPaid = DBNull.Value.Equals(dr["Quantity"]) ? 0 : Convert.ToInt16(dr["Quantity"]);
                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }




        #endregion


        #region---vendorewise---

        public ActionResult vendorewise()
        {
            Vendorwisepurchase();
            pur();
            Datewise();
            Purchas1();
            return View();

        }

        public ActionResult Vendorwisepurchase()
        {
            List<SalesOrder> g = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_vendorePurchase", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder j = new SalesOrder();

                        j.Clientname = DBNull.Value.Equals(dr["NAME"]) ? " " : Convert.ToString(dr["NAME"]);
                        j.Amount = DBNull.Value.Equals(dr["PurchasePrise"]) ? 0 : Convert.ToInt16(dr["PurchasePrise"]);
                        g.Add(j);
                    }
                    return Json(g, JsonRequestBehavior.AllowGet);
                }
            }
        }
        public ActionResult VendoreName1(string Fromdate, string Todate)
        {
            List<SalesOrder> g = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_VendoreName1", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder j = new SalesOrder();

                        j.Clientname = DBNull.Value.Equals(dr["NAME"]) ? " " : Convert.ToString(dr["NAME"]);
                        j.Amount = DBNull.Value.Equals(dr["PurchasePrise"]) ? 0 : Convert.ToInt16(dr["PurchasePrise"]);
                        g.Add(j);
                    }
                    return Json(g, JsonRequestBehavior.AllowGet);
                }
            }
        }

        public ActionResult pur()
        {
            List<SalesOrder> g = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();

                using (cmd = new SqlCommand("sp_venrecdreturn", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder j = new SalesOrder();
                        j.Genericname = DBNull.Value.Equals(dr["NAME"]) ? "" : Convert.ToString(dr["NAME"]);
                        j.Amount = DBNull.Value.Equals(dr["RecvQty"]) ? 0 : Convert.ToInt16(dr["RecvQty"]);
                        j.AmountPaid = DBNull.Value.Equals(dr["ReturnedPack"]) ? 0 : Convert.ToInt16(dr["ReturnedPack"]);
                        g.Add(j);
                    }
                    return Json(g, JsonRequestBehavior.AllowGet);
                }   
            }
        }
        public ActionResult pur1(string Fromdate, string Todate)
        {
            List<SalesOrder> g = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();

                using (cmd = new SqlCommand("sp_pur1", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder j = new SalesOrder();
                        j.Genericname = DBNull.Value.Equals(dr["NAME"]) ? "" : Convert.ToString(dr["NAME"]);
                        j.Amount = DBNull.Value.Equals(dr["RecvQty"]) ? 0 : Convert.ToInt16(dr["RecvQty"]);
                        j.AmountPaid = DBNull.Value.Equals(dr["ReturnedPack"]) ? 0 : Convert.ToInt16(dr["ReturnedPack"]);
                        g.Add(j);
                    }
                    return Json(g, JsonRequestBehavior.AllowGet);
                }
            }
        }
        public ActionResult Datewise()
        {
            List<SalesOrder> g = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();

                using (cmd = new SqlCommand("sp_daywisePurchase", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder j = new SalesOrder();
                        j.Genericname = DBNull.Value.Equals(dr["Date1"]) ? "" : Convert.ToString(dr["Date1"]);
                        j.Amount = DBNull.Value.Equals(dr["PurchaseTotal"]) ? 0 : Convert.ToInt16(dr["PurchaseTotal"]);
                        // j.AmountPaid = DBNull.Value.Equals(dr["ReturnedPack"]) ? 0 : Convert.ToInt16(dr["ReturnedPack"]);
                        g.Add(j);
                    }
                    return Json(g, JsonRequestBehavior.AllowGet);
                }
            }
        }
        public ActionResult Datewise1(string Fromdate, string Todate)
        {
            List<SalesOrder> g = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();

                using (cmd = new SqlCommand("sp_daywisePurchase1", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder j = new SalesOrder();
                        j.Genericname = DBNull.Value.Equals(dr["Date1"]) ? "" : Convert.ToString(dr["Date1"]);
                        j.Amount = DBNull.Value.Equals(dr["PurchaseTotal"]) ? 0 : Convert.ToInt16(dr["PurchaseTotal"]);
                        // j.AmountPaid = DBNull.Value.Equals(dr["ReturnedPack"]) ? 0 : Convert.ToInt16(dr["ReturnedPack"]);
                        g.Add(j);
                    }
                    return Json(g, JsonRequestBehavior.AllowGet);
                }
            }
        }

        public ActionResult Purchas1()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_purchasedash", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.Amount = DBNull.Value.Equals(dr["POAprroved"]) ? 0 : Convert.ToInt16(dr["POAprroved"]);
                        obj1.AmountPaid = DBNull.Value.Equals(dr["PORejected"]) ? 0 : Convert.ToInt16(dr["PORejected"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["POPending"]) ? 0 : Convert.ToInt16(dr["POPending"]);

                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Purchas11(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_Purchas11", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.Amount = DBNull.Value.Equals(dr["POAprroved"]) ? 0 : Convert.ToInt16(dr["POAprroved"]);
                        obj1.AmountPaid = DBNull.Value.Equals(dr["PORejected"]) ? 0 : Convert.ToInt16(dr["PORejected"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["POPending"]) ? 0 : Convert.ToInt16(dr["POPending"]);

                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }


        #endregion
        //#region---Purchase status--//

        //public ActionResult purchasestatus()
        //{

        //    Purchas2();
        //    Purchas3();
        //    Purchas6();
        //    return View();
        //}



        //public ActionResult Purchas2()
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<SalesOrder> li = new List<SalesOrder>();
        //    SalesOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("", con))
        //        {
        //            //cmd.CommandType = CommandType.StoredProcedure;
        //           // cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
        //           // cmd.Parameters.Add(new SqlParameter("@todate", Todate));
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new SalesOrder();
        //                //obj1.Clientname = DBNull.Value.Equals(dr["Date1"]) ? "" : Convert.ToString(dr["Date1"]);
        //                obj1.BillAmount = DBNull.Value.Equals(dr["OrderTotal"]) ? 0.0m : Convert.ToDecimal(dr["OrderTotal"]);
        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }
        //}



        //public ActionResult Purchas3()
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<SalesOrder> li = new List<SalesOrder>();
        //    SalesOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("SELECT  sum(OrderTotal)as OrderTotal ,sum(Tax1Rate)as Tax1Rate,sum(PurchaseTotal)as PurchaseTotal from po_purchaseorder where ActiveFlag=1", con))
        //        {
        //            //cmd.CommandType = CommandType.StoredProcedure;
        //            //cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
        //            //cmd.Parameters.Add(new SqlParameter("@todate", Todate));
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new SalesOrder();
        //                obj1.Amount = DBNull.Value.Equals(dr["PurchaseTotal"]) ? 0 : Convert.ToInt64(dr["PurchaseTotal"]);
        //                obj1.AmountPaid = DBNull.Value.Equals(dr["OrderTotal"]) ? 0 : Convert.ToInt64(dr["OrderTotal"]);
        //                obj1.BillAmount = DBNull.Value.Equals(dr["Tax1Rate"]) ? 0 : Convert.ToInt64(dr["Tax1Rate"]);
        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }
        //}

        //public ActionResult Purchas6()
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<SalesOrder> li = new List<SalesOrder>();
        //    SalesOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("SELECT  sum(InvoiceSubTotal)as InvoiceSubTotal ,sum(InvoiceTotal)as InvoiceTotal,sum(InvoiceBalance)as InvoiceBalance from SO_SalesOrder where ActiveFlag=1", con))
        //        {
        //            //cmd.CommandType = CommandType.StoredProcedure;
        //            // cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
        //            // cmd.Parameters.Add(new SqlParameter("@todate", Todate));
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new SalesOrder();
        //                // obj1.Clientname = DBNull.Value.Equals(dr["date"]) ? "" : Convert.ToString(dr["date"]);
        //                obj1.Amount = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? 0 : Convert.ToInt64(dr["InvoiceSubTotal"]);
        //                obj1.AmountPaid = DBNull.Value.Equals(dr["InvoiceTotal"]) ? 0 : Convert.ToInt64(dr["InvoiceTotal"]);
        //                obj1.BillAmount = DBNull.Value.Equals(dr["InvoiceBalance"]) ? 0 : Convert.ToInt64(dr["InvoiceBalance"]);
        //               // obj1.Balance = DBNull.Value.Equals(dr["InvoiceBalance"]) ? 0 : Convert.ToInt16(dr["InvoiceBalance"]);
        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }
        //}


        //public ActionResult Purchas21(string Fromdate, string Todate)
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<SalesOrder> li = new List<SalesOrder>();
        //    SalesOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("sp_Purchas21", con))
        //        {
        //            cmd.CommandType = CommandType.StoredProcedure;
        //            cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
        //            cmd.Parameters.Add(new SqlParameter("@ToDate", Todate)); 
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new SalesOrder();
        //                //obj1.Clientname = DBNull.Value.Equals(dr["Date1"]) ? "" : Convert.ToString(dr["Date1"]);
        //                obj1.BillAmount = DBNull.Value.Equals(dr["OrderTotal"]) ? 0.0m : Convert.ToDecimal(dr["OrderTotal"]);
        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }
        //}
        //public ActionResult Purchas31(string Fromdate, string Todate)
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<SalesOrder> li = new List<SalesOrder>();
        //    SalesOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("sp_Purchas31", con))
        //        {
        //            cmd.CommandType = CommandType.StoredProcedure;
        //            cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
        //            cmd.Parameters.Add(new SqlParameter("@ToDate", Todate)); 
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new SalesOrder();
        //                obj1.Amount = DBNull.Value.Equals(dr["PurchaseTotal"]) ? 0 : Convert.ToInt16(dr["PurchaseTotal"]);
        //                obj1.AmountPaid = DBNull.Value.Equals(dr["OrderTotal"]) ? 0 : Convert.ToInt16(dr["OrderTotal"]);
        //                obj1.BillAmount = DBNull.Value.Equals(dr["Tax1Rate"]) ? 0 : Convert.ToInt16(dr["Tax1Rate"]);
        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }
        //}
        //public ActionResult Purchas61(string Fromdate, string Todate)
        //{
        //    SqlConnection con = null;
        //    SqlCommand cmd = null;
        //    SqlDataReader dr;
        //    List<SalesOrder> li = new List<SalesOrder>();
        //    SalesOrder obj1;
        //    using (con = new SqlConnection(cs))
        //    {
        //        con.Open();
        //        con.CreateCommand();
        //        using (cmd = new SqlCommand("sp_Purchas61", con))
        //        {
        //            cmd.CommandType = CommandType.StoredProcedure;
        //            cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
        //            cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));    
        //            dr = cmd.ExecuteReader();
        //            while (dr.Read())
        //            {
        //                obj1 = new SalesOrder();
        //                // obj1.Clientname = DBNull.Value.Equals(dr["date"]) ? "" : Convert.ToString(dr["date"]);
        //                obj1.Amount = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? 0 : Convert.ToInt16(dr["InvoiceSubTotal"]);
        //                obj1.AmountPaid = DBNull.Value.Equals(dr["InvoiceTotal"]) ? 0 : Convert.ToInt16(dr["InvoiceTotal"]);
        //                obj1.BillAmount = DBNull.Value.Equals(dr["InvoiceBalance"]) ? 0 : Convert.ToInt16(dr["InvoiceBalance"]);
        //                // obj1.Balance = DBNull.Value.Equals(dr["InvoiceBalance"]) ? 0 : Convert.ToInt16(dr["InvoiceBalance"]);
        //                li.Add(obj1);
        //            }
        //        }
        //        return Json(li, JsonRequestBehavior.AllowGet);
        //    }
        //}




        //#endregion

        #region---Approvalhistory---//

        public ActionResult Approvalhistoroy()
        {
            HealthCareInMvc4.RoleProfileServiceRef.RoleProfile objuser = new HealthCareInMvc4.RoleProfileServiceRef.RoleProfile();
            objuser = (HealthCareInMvc4.RoleProfileServiceRef.RoleProfile)Session["UserList"];
            Int64 UserID = objuser.UserID;
            Session["userid"] = UserID;

            Int64 ClientID = objuser.ClientID;
            Session["clientid"] = ClientID;
            MainStoreSubStoreServiceClient objresult = new MainStoreSubStoreServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "MainStoreSubStoreService.svc")));
            var list = objresult.MainStoreListByModuleID(5, Convert.ToString(ClientID), UserID);
            ViewBag.list = new SelectList(list.AsEnumerable(), "MainStoreID", "MainStoreName", list.FirstOrDefault().MainStoreID);

            //IndentRequestServiceClient indentlist = new IndentRequestServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "IndentRequestService.svc")));
            //var sublist = indentlist.ListSubstore(5, 1, ClientID, UserID);
            //ViewBag.sublist = new SelectList(sublist.AsEnumerable(), "SubStoreID", "SubStoreName", sublist.FirstOrDefault().SubStoreID);

            ChartViewModel _ChartViewModel = new ChartViewModel();
            _ChartViewModel.SalesOrderProduct = Approvaldetaily();
            _ChartViewModel.SalesOrderDayWise = Approvaldetaily12();
            return View(_ChartViewModel);
        }

        public List<SalesOrder> Approvaldetaily()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_approvaldetail", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder l = new SalesOrder();
                        l.AmountPaid = DBNull.Value.Equals(dr["POAprroved"]) ? 0 : Convert.ToInt32(dr["POAprroved"]);
                        l.Balance = DBNull.Value.Equals(dr["PORejected"]) ? 0 : Convert.ToInt32(dr["PORejected"]);
                        l.Amount = DBNull.Value.Equals(dr["POPending"]) ? 0 : Convert.ToInt32(dr["POPending"]);
                        obj.Add(l);
                    }
                }
            }
            return obj;
        }
        public List<SalesOrder> Approvaldetaily12()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                //using (cmd = new SqlCommand("select (select count(CustomerCategory) as CustomerCategory  from SO_SalesOrder where CreatedDate between  convert(datetime, '2015-06-16 08:25:46.693',102) and convert(datetime,'2015-06-16 13:50:11.970',102) and CustomerCategory=0) as Ip,(select count(CustomerCategory) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =0 and CreatedDate between  convert(datetime, '2015-06-16 08:25:46.693',102) and convert(datetime,'2015-06-16 13:50:11.970',102)) as OP,(select count(CustomerCategory) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =2 and CreatedDate between  convert(datetime, '2015-06-16 08:25:46.693',102) and convert(datetime,'2015-06-16 13:50:11.970',102)) as Do,(select count(CustomerCategory) as CustomerCategory  from SO_SalesOrder where  CustomerCategory =3 and CreatedDate between  convert(datetime, '2015-06-16 08:25:46.693',102) and convert(datetime,'2015-06-16 13:50:11.970',102)) as General", conn))
                using (cmd = new SqlCommand("sp_tabledash", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        obj1.Name = DBNull.Value.Equals(dr["Name"]) ? " " : Convert.ToString(dr["Name"]);
                        obj1.ProductName = DBNull.Value.Equals(dr["status"]) ? "" : Convert.ToString(dr["status"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["PurchasePrise"]) ? 0 : Convert.ToInt64(dr["PurchasePrise"]);

                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }


        public ActionResult PoPending()
        {
            List<SalesOrder> k = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_Popending", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder l = new SalesOrder();
                        l.Name = DBNull.Value.Equals(dr["Name"]) ? " " : Convert.ToString(dr["Name"]);
                        l.AmountPaid = DBNull.Value.Equals(dr["PurchasePrice"]) ? 0 : Convert.ToInt16(dr["PurchasePrice"]);
                        k.Add(l);
                    }
                    return Json(k, JsonRequestBehavior.AllowGet);
                }
            }
        }
        public ActionResult PoPending1(string Fromdate, string Todate)
        {
            List<SalesOrder> k = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_PoPending1", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder l = new SalesOrder();
                        l.Name = DBNull.Value.Equals(dr["Name"]) ? " " : Convert.ToString(dr["Name"]);
                        l.AmountPaid = DBNull.Value.Equals(dr["PurchasePrice"]) ? 0 : Convert.ToInt16(dr["PurchasePrice"]);
                        k.Add(l);
                    }
                    return Json(k, JsonRequestBehavior.AllowGet);
                }
            }
        }
        public ActionResult PORejected()
        {
            List<SalesOrder> k = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_PORejected", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder l = new SalesOrder();
                        l.Name = DBNull.Value.Equals(dr["Name"]) ? " " : Convert.ToString(dr["Name"]);
                        l.AmountPaid = DBNull.Value.Equals(dr["PurchasePrice"]) ? 0 : Convert.ToInt16(dr["PurchasePrice"]);
                        k.Add(l);
                    }
                    return Json(k, JsonRequestBehavior.AllowGet);
                }
            }
        }
        public ActionResult PORejected1(string Fromdate, string Todate)
        {
            List<SalesOrder> k = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("PORejected1", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder l = new SalesOrder();
                        l.Name = DBNull.Value.Equals(dr["Name"]) ? " " : Convert.ToString(dr["Name"]);
                        l.AmountPaid = DBNull.Value.Equals(dr["PurchasePrice"]) ? 0 : Convert.ToInt16(dr["PurchasePrice"]);
                        k.Add(l);
                    }
                    return Json(k, JsonRequestBehavior.AllowGet);
                }
            }
        }
        public ActionResult POapproval()
        {
            List<SalesOrder> k = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_POapproval", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder l = new SalesOrder();
                        l.Name = DBNull.Value.Equals(dr["Name"]) ? " " : Convert.ToString(dr["Name"]);
                        l.AmountPaid = DBNull.Value.Equals(dr["PurchasePrice"]) ? 0 : Convert.ToInt16(dr["PurchasePrice"]);
                        k.Add(l);
                    }
                    return Json(k, JsonRequestBehavior.AllowGet);
                }
            }
        }
        public ActionResult POapproval1(string Fromdate, string Todate)
        {
            List<SalesOrder> k = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_POapproval1", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder l = new SalesOrder();
                        l.Name = DBNull.Value.Equals(dr["Name"]) ? " " : Convert.ToString(dr["Name"]);
                        l.AmountPaid = DBNull.Value.Equals(dr["PurchasePrice"]) ? 0 : Convert.ToInt16(dr["PurchasePrice"]);

                        k.Add(l);
                    }
                    return Json(k, JsonRequestBehavior.AllowGet);
                }
            }
        }
        public ActionResult approvaldetails()
        {
            List<SalesOrder> k = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_approvaldetail", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder l = new SalesOrder();
                        l.AmountPaid = DBNull.Value.Equals(dr["POAprroved"]) ? 0 : Convert.ToInt32(dr["POAprroved"]);
                        l.Balance = DBNull.Value.Equals(dr["PORejected"]) ? 0 : Convert.ToInt32(dr["PORejected"]);
                        l.Amount = DBNull.Value.Equals(dr["POPending"]) ? 0 : Convert.ToInt32(dr["POPending"]);
                        k.Add(l);
                    }
                    return Json(k, JsonRequestBehavior.AllowGet);
                }
            }
        }
        public ActionResult approvaldetails1(string Fromdate, string Todate)
        {
            List<SalesOrder> k = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_approvaldetails1", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder l = new SalesOrder();
                        l.AmountPaid = DBNull.Value.Equals(dr["POAprroved"]) ? 0 : Convert.ToInt32(dr["POAprroved"]);
                        l.Balance = DBNull.Value.Equals(dr["PORejected"]) ? 0 : Convert.ToInt32(dr["PORejected"]);
                        l.Amount = DBNull.Value.Equals(dr["POPending"]) ? 0 : Convert.ToInt32(dr["POPending"]);
                        k.Add(l);
                    }
                    return Json(k, JsonRequestBehavior.AllowGet);
                }
            }
        }


        #endregion

        #region---currentstock---//

        public ActionResult Currentstock()
        {
            HealthCareInMvc4.RoleProfileServiceRef.RoleProfile objuser = new HealthCareInMvc4.RoleProfileServiceRef.RoleProfile();
            objuser = (HealthCareInMvc4.RoleProfileServiceRef.RoleProfile)Session["UserList"];
            Int64 UserID = objuser.UserID;
            Session["userid"] = UserID;

            Int64 ClientID = objuser.ClientID;
            Session["clientid"] = ClientID;
            MainStoreSubStoreServiceClient objresult = new MainStoreSubStoreServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "MainStoreSubStoreService.svc")));
            var list = objresult.MainStoreListByModuleID(5, Convert.ToString(ClientID), UserID);
            ViewBag.list = new SelectList(list.AsEnumerable(), "MainStoreID", "MainStoreName", list.FirstOrDefault().MainStoreID);

            //IndentRequestServiceClient indentlist = new IndentRequestServiceClient(RIAGlobal.GetBinding(), new EndpointAddress(RIAGlobal.GetServicePath(Servicepath, "IndentRequestService.svc")));
            //var sublist = indentlist.ListSubstore(5, 1, ClientID, UserID);
            //ViewBag.sublist = new SelectList(sublist.AsEnumerable(), "SubStoreID", "SubStoreName", sublist.FirstOrDefault().SubStoreID);

            ChartViewModel _ChartViewModel = new ChartViewModel();
            _ChartViewModel.SalesOrderProduct = Currentdetaily();
            _ChartViewModel.SalesOrderDayWise = Currentdetailydetaily12();



            return View(_ChartViewModel);
        }

        public List<SalesOrder> Currentdetaily()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_tablecurrent12", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        obj1.Name = DBNull.Value.Equals(dr["ProductName"]) ? "" : Convert.ToString(dr["ProductName"]);
                        obj1.Cond = DBNull.Value.Equals(dr["Quantity"]) ? 0 : Convert.ToInt32(dr["Quantity"]);
                        obj1.CreatedBy = DBNull.Value.Equals(dr["SalesPrice"]) ? 0 : Convert.ToInt32(dr["SalesPrice"]);
                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }

        public List<SalesOrder> Currentdetailydetaily12()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_tablecurrent", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        string dat;

                        obj1.Name = DBNull.Value.Equals(dr["SubStoreName"]) ? "" : Convert.ToString(dr["SubStoreName"]);
                        obj1.ProductName = DBNull.Value.Equals(dr["ProductName"]) ? "" : Convert.ToString(dr["ProductName"]);
                        obj1.Customercategory = DBNull.Value.Equals(dr["Quantity"]) ? 0 : Convert.ToInt32(dr["Quantity"]);
                        dat = DBNull.Value.Equals(dr["exprirydate"]) ? "" : Convert.ToString(dr["exprirydate"]);
                        //obj.Add(obj1);
                        if (dat == "")
                        {
                            obj1.Age = dat;
                        }
                        else
                        {
                            string[] arrDate = dat.Split('-');
                            string day = arrDate[2].ToString();
                            string month = arrDate[1].ToString();
                            string year = arrDate[0].ToString();
                            obj1.Age = day + "-" + month + "-" + year;
                        }
                        obj.Add(obj1);
                    }

                }
            }
            return obj;
        }





        public ActionResult currentstock2()
        {
            List<SalesOrder> h = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_currentstockProd", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder m = new SalesOrder();
                        m.Clientname = DBNull.Value.Equals(dr["name"]) ? "" : Convert.ToString(dr["name"]);
                        m.AmountPaid = DBNull.Value.Equals(dr["MAINAvailableQty"]) ? 0 : Convert.ToInt16(dr["MAINAvailableQty"]);
                        h.Add(m);
                    }
                }
                return Json(h, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult currentstock1(string Fromdate, string Todate)
        {
            List<SalesOrder> h = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_currentstockProd1", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder m = new SalesOrder();
                        m.Clientname = DBNull.Value.Equals(dr["name"]) ? "" : Convert.ToString(dr["name"]);
                        m.AmountPaid = DBNull.Value.Equals(dr["MAINAvailableQty"]) ? 0 : Convert.ToInt16(dr["MAINAvailableQty"]);
                        h.Add(m);
                    }
                }
                return Json(h, JsonRequestBehavior.AllowGet);
            }
        }

        public ActionResult Quantityrate()
        {
            List<SalesOrder> h = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_quantitysales", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder m = new SalesOrder();
                        m.Clientname = DBNull.Value.Equals(dr["ProductTypeName"]) ? "" : Convert.ToString(dr["ProductTypeName"]);
                        m.AmountPaid = DBNull.Value.Equals(dr["Quantity"]) ? 0 : Convert.ToInt16(dr["Quantity"]);
                        m.Amount = DBNull.Value.Equals(dr["Rate"]) ? 0 : Convert.ToInt16(dr["Rate"]);
                        h.Add(m);
                    }
                }
                return Json(h, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Quantityrate1(string Fromdate, string Todate)
        {
            List<SalesOrder> h = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_ProductRste23", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder m = new SalesOrder();
                        m.Clientname = DBNull.Value.Equals(dr["ProductTypeName"]) ? "" : Convert.ToString(dr["ProductTypeName"]);
                        m.AmountPaid = DBNull.Value.Equals(dr["Quantity"]) ? 0 : Convert.ToInt16(dr["Quantity"]);
                        m.Amount = DBNull.Value.Equals(dr["Rate"]) ? 0 : Convert.ToInt16(dr["Rate"]);
                        h.Add(m);
                    }
                }
                return Json(h, JsonRequestBehavior.AllowGet);
            }
        }

        public ActionResult Storewisecurrentstock()
        {
            List<SalesOrder> h = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_storewisecurrentstockdash", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder m = new SalesOrder();
                        m.BaseEntityName = DBNull.Value.Equals(dr["SubStoreName"]) ? "" : Convert.ToString(dr["SubStoreName"]);
                        m.Amount = DBNull.Value.Equals(dr["Quantity"]) ? 0 : Convert.ToInt16(dr["Quantity"]);
                        //  m.AmountPaid = DBNull.Value.Equals(dr["SalesPrice"]) ? 0 : Convert.ToInt16(dr["SalesPrice"]);
                        // m.InvoiceBalance = DBNull.Value.Equals(dr["Total"]) ? 0 : Convert.ToInt16(dr["Total"]);
                        h.Add(m);
                    }
                }
                return Json(h, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Storewisecurrentstock1(string Fromdate, string Todate)
        {
            List<SalesOrder> h = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_Product11", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder m = new SalesOrder();
                        m.BaseEntityName = DBNull.Value.Equals(dr["SubStoreName"]) ? "" : Convert.ToString(dr["SubStoreName"]);
                        m.Amount = DBNull.Value.Equals(dr["Quantity"]) ? 0 : Convert.ToInt16(dr["Quantity"]);
                        //  m.AmountPaid = DBNull.Value.Equals(dr["SalesPrice"]) ? 0 : Convert.ToInt16(dr["SalesPrice"]);
                        // m.InvoiceBalance = DBNull.Value.Equals(dr["Total"]) ? 0 : Convert.ToInt16(dr["Total"]);
                        h.Add(m);
                    }
                }
                return Json(h, JsonRequestBehavior.AllowGet);
            }
        }

        public ActionResult salesvalue()
        {
            List<SalesOrder> h = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_salesvaluedash", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder m = new SalesOrder();
                        m.BaseEntityName = DBNull.Value.Equals(dr["NAME"]) ? "" : Convert.ToString(dr["NAME"]);
                        m.AmountPaid = DBNull.Value.Equals(dr["SalesPrise"]) ? 0 : Convert.ToInt16(dr["SalesPrise"]);
                        m.InvoiceBalance = DBNull.Value.Equals(dr["quantity"]) ? 0 : Convert.ToInt16(dr["quantity"]);
                        h.Add(m);
                    }
                }
                return Json(h, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult salesvalue1(string Fromdate, string Todate)
        {
            List<SalesOrder> h = new List<SalesOrder>();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = conn.CreateCommand();
                using (cmd = new SqlCommand("sp_salesvaluedash1", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder m = new SalesOrder();
                        m.BaseEntityName = DBNull.Value.Equals(dr["NAME"]) ? "" : Convert.ToString(dr["NAME"]);
                        m.AmountPaid = DBNull.Value.Equals(dr["SalesPrise"]) ? 0 : Convert.ToInt16(dr["SalesPrise"]);
                        m.InvoiceBalance = DBNull.Value.Equals(dr["quantity"]) ? 0 : Convert.ToInt16(dr["quantity"]);
                        h.Add(m);
                    }
                }
                return Json(h, JsonRequestBehavior.AllowGet);
            }
        }








        #endregion

        #region---Timewise Purchase---
        public ActionResult TimewisePurchase()
        {
            Timewisestore();
            dayTimesubstore();
            Indentrequest12();
            topboughtproducts12();
            return View();
        }

        public ActionResult Timewisestore()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_storesales", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? "" : Convert.ToString(dr["SubStoreName"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? 0.0m : Convert.ToDecimal(dr["InvoiceSubTotal"]);
                        obj.Add(obj1);

                    }
                }
            }
            return Json(obj, JsonRequestBehavior.AllowGet);
        }
        public ActionResult dayTimesubstore()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("Sp_Datewisesale", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;

                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {

                        obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["Date1"]) ? "" : Convert.ToString(dr["Date1"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["Total"]) ? 0.0m : Convert.ToDecimal(dr["Total"]);


                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Indentrequest12()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_indentrequest12", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    // cmd.Parameters.Add(new SqlParameter("@value", value));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.SubStoreName = Convert.ToString(dr["SubStoreName"]);
                        obj1.TotalRequest = DBNull.Value.Equals(dr["TotalRequest"]) ? 0 : Convert.ToInt64(dr["TotalRequest"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }

        }
        public ActionResult topboughtproducts12()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_topboughtproducts12", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.Productname = Convert.ToString(dr["Productname"]);
                        obj1.TotalCOunt = DBNull.Value.Equals(dr["Totalcount"]) ? 0 : Convert.ToInt64(dr["Totalcount"]);  // Convert.ToInt64(dr["SubTotal"]);
                        // obj1.Subtotal = DBNull.Value.Equals(dr["Subtotal"]) ? 0 : Convert.ToInt64(dr["Subtotal"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }






        public ActionResult Timewisestore1(string Fromdate, string Todate)
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_storesalesdash", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? "" : Convert.ToString(dr["SubStoreName"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["InvoiceSubTotal"]) ? 0.0m : Convert.ToDecimal(dr["InvoiceSubTotal"]);
                        obj.Add(obj1);

                    }
                }
            }
            return Json(obj, JsonRequestBehavior.AllowGet);
        }
        public ActionResult dayTimesubstore1(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("Sp_Datewisesaledas", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {

                        obj1 = new SalesOrder();
                        obj1.Clientname = DBNull.Value.Equals(dr["Date1"]) ? "" : Convert.ToString(dr["Date1"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["Total"]) ? 0.0m : Convert.ToDecimal(dr["Total"]);


                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Indentrequestdashw(String Fromdate, String Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_indentrequest", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@fromdate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@todate", Todate));
                    // cmd.Parameters.Add(new SqlParameter("@value", value));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.SubStoreName = Convert.ToString(dr["SubStoreName"]);
                        obj1.TotalRequest = DBNull.Value.Equals(dr["TotalRequest"]) ? 0 : Convert.ToInt64(dr["TotalRequest"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }

        }
        public ActionResult topboughtproductsdash(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<PurchaseOrder> li = new List<PurchaseOrder>();
            PurchaseOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_topboughtproducts", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new PurchaseOrder();
                        obj1.Productname = Convert.ToString(dr["Productname"]);
                        obj1.TotalCOunt = DBNull.Value.Equals(dr["Totalcount"]) ? 0 : Convert.ToInt64(dr["Totalcount"]);  // Convert.ToInt64(dr["SubTotal"]);
                        // obj1.Subtotal = DBNull.Value.Equals(dr["Subtotal"]) ? 0 : Convert.ToInt64(dr["Subtotal"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }




        #endregion

        //-----Lab result----
        #region lab

        public ActionResult Result()
        {
            ChartViewModel _ChartViewModel = new ChartViewModel();
            ViewBag.Result1 = resulttab1();
            ViewBag.Result2 = resulttab2();
            return View();
        }
        public ActionResult result1(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new { ResultApproval = 0, Resultpending = 0, ResultRejected = 0 };

            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_resultapprovalpiechart", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval = new
                        {
                            ResultApproval = DBNull.Value.Equals(dr["Resultapproval"]) ? 0 : Convert.ToInt32(dr["Resultapproval"]),
                            Resultpending = DBNull.Value.Equals(dr["ResultPending"]) ? 0 : Convert.ToInt32(dr["ResultPending"]),
                            ResultRejected = DBNull.Value.Equals(dr["ResultRejected"]) ? 0 : Convert.ToInt32(dr["ResultRejected"])
                        };

                    }
                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult result2(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { TestName = "", NoOfresultPending = 0 } }.ToList();

            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_pendingresulttestchart", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval.Add(new
                        {
                            TestName = DBNull.Value.Equals(dr["TestName"]) ? "" : Convert.ToString(dr["TestName"]),
                            NoOfresultPending = DBNull.Value.Equals(dr["NoOfresultPending"]) ? 0 : Convert.ToInt32(dr["NoOfresultPending"])
                        }
                    );
                    }
                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult result3(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { DepartmentName = "", NoOfresultPending = 0 } }.ToList();

            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_pendingresultdeptchart", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval.Add(new
                        {
                            DepartmentName = DBNull.Value.Equals(dr["DepartmentName"]) ? "" : Convert.ToString(dr["DepartmentName"]),
                            NoOfresultPending = DBNull.Value.Equals(dr["NoOfresultPending"]) ? 0 : Convert.ToInt32(dr["NoOfresultPending"])
                        }
                        );

                    }
                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult result4(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new { ResultEntered = 0, ResultNotEntered = 0 };

            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_ResultEntrystatuschart", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval = new
                        {
                            ResultEntered = DBNull.Value.Equals(dr["ResultEntered"]) ? 0 : Convert.ToInt32(dr["ResultEntered"]),
                            ResultNotEntered = DBNull.Value.Equals(dr["ResultNotEntered"]) ? 0 : Convert.ToInt32(dr["ResultNotEntered"])
                        };
                    }
                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        //-----Lab due----
        public ActionResult Due()
        {
            ChartViewModel _ChartViewModel = new ChartViewModel();
            ViewBag.due1 = duetab1();
            ViewBag.due2 = duetab2();
            return View();
        }
        public ActionResult due1(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new { Dues = 0, DueCollected = 0, Total = 0 };

            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_duedetailpiechart ", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval = new
                        {
                            Dues = DBNull.Value.Equals(dr["Dues"]) ? 0 : Convert.ToInt32(dr["Dues"]),
                            DueCollected = DBNull.Value.Equals(dr["DueCollected"]) ? 0 : Convert.ToInt32(dr["DueCollected"]),
                            Total = DBNull.Value.Equals(dr["Total"]) ? 0 : Convert.ToInt32(dr["Total"])
                        };
                    }
                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult due2(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { payment = "", no = 0 } }.ToList();

            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_Paymentmodewisechart ", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    //cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    //cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval.Add(new
                        {
                            payment = DBNull.Value.Equals(dr["payment"]) ? "" : Convert.ToString(dr["payment"]),
                            no = DBNull.Value.Equals(dr["no"]) ? 0 : Convert.ToInt32(dr["no"])
                        }
                        );
                    }
                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult due3(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { Patientname = "", TotalAmount = 0 } }.ToList();

            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_patientwisebillchart ", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval.Add(new
                        {
                            Patientname = DBNull.Value.Equals(dr["Patientname"]) ? "" : Convert.ToString(dr["Patientname"]),
                            TotalAmount = DBNull.Value.Equals(dr["TotalAmount"]) ? 0 : Convert.ToInt32(dr["TotalAmount"])
                        }
                        );
                    }
                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult due4(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new { NormalPay = 0, DiscountPay = 0 };

            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_nofodiscountchart ", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval = new
                        {

                            NormalPay = DBNull.Value.Equals(dr["NormalPay"]) ? 0 : Convert.ToInt32(dr["NormalPay"]),
                            DiscountPay = DBNull.Value.Equals(dr["DiscountPay"]) ? 0 : Convert.ToInt32(dr["DiscountPay"])

                        };
                    }
                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        //-----Lab patient----
        public ActionResult Patient()
        {
            ChartViewModel _ChartViewModel = new ChartViewModel();
            ViewBag.patient1 = patienttab1();
            ViewBag.patient2 = patienttab2();
            return View();
        }
        public ActionResult Patient1(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { DepartmentName = "", Tested = 0 } }.ToList();
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_departmentwisepiechart", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval.Add(new
                        {
                            DepartmentName = DBNull.Value.Equals(dr["DepartmentName"]) ? "" : Convert.ToString(dr["DepartmentName"]),
                            Tested = DBNull.Value.Equals(dr["Tested"]) ? 0 : Convert.ToInt32(dr["Tested"])
                        }
                         );

                    }

                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Patient2(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { Testname = "", Total = 0 } }.ToList();
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_monthlytestwisechart", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval.Add(new
                        {
                            Testname = DBNull.Value.Equals(dr["Testname"]) ? "" : Convert.ToString(dr["Testname"]),
                            Total = DBNull.Value.Equals(dr["Total"]) ? 0 : Convert.ToInt32(dr["Total"])
                        });

                    }

                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Patient3(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { PatientName = "", NoOfTimes = 0 } }.ToList();
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_Repeatedpatientchart", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    //cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    //cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval.Add(new
                        {
                            PatientName = DBNull.Value.Equals(dr["PatientName"]) ? "" : Convert.ToString(dr["PatientName"]),
                            NoOfTimes = DBNull.Value.Equals(dr["NoOfTimes"]) ? 0 : Convert.ToInt32(dr["NoOfTimes"])
                        });

                    }

                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Patient4(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { DoctorName = "", NOofpatient = 0 } }.ToList();
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_Docwisepatientchart", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    // cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    //cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval.Add(new
                        {
                            DoctorName = DBNull.Value.Equals(dr["DoctorName"]) ? "" : Convert.ToString(dr["DoctorName"]),
                            NOofpatient = DBNull.Value.Equals(dr["NOofpatient"]) ? 0 : Convert.ToInt32(dr["NOofpatient"])
                        });

                    }

                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult Patient5(string Fromdate, string Todate)
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { time = "", NOofpatient = 0 } }.ToList();
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_Timewisepatientchart", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    // cmd.Parameters.Add(new SqlParameter("@FromDate", Fromdate));
                    // cmd.Parameters.Add(new SqlParameter("@ToDate", Todate));
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        resultapproval.Add(new
                        {
                            time = DBNull.Value.Equals(dr["time"]) ? "" : Convert.ToString(dr["time"]),
                            NOofpatient = DBNull.Value.Equals(dr["NOofpatient"]) ? 0 : Convert.ToInt32(dr["NOofpatient"])
                        });

                    }

                }
                return Json(resultapproval, JsonRequestBehavior.AllowGet);
            }
        }




        public List<SalesOrder> resulttab1()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { ResultApproval = 0, Resultpending = 0, ResultRejected = 0 } }.ToList();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_resultapprovalpiechart", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        obj1.Amount = DBNull.Value.Equals(dr["Resultapproval"]) ? 0 : Convert.ToInt32(dr["Resultapproval"]);
                        obj1.AmountPaid = DBNull.Value.Equals(dr["ResultPending"]) ? 0 : Convert.ToInt32(dr["ResultPending"]);
                        obj1.Barcode1 = DBNull.Value.Equals(dr["ResultRejected"]) ? 0 : Convert.ToInt32(dr["ResultRejected"]);
                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }
        public List<SalesOrder> resulttab2()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { ResultApproval = 0, Resultpending = 0, ResultRejected = 0 } }.ToList();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_ResultEntrystatuschart", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();

                        obj1.Balance = DBNull.Value.Equals(dr["ResultEntered"]) ? 0 : Convert.ToInt32(dr["ResultEntered"]);
                        obj1.Barcode1 = DBNull.Value.Equals(dr["ResultNotEntered"]) ? 0 : Convert.ToInt32(dr["ResultNotEntered"]);
                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }
        public List<SalesOrder> patienttab1()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { ResultApproval = 0, Resultpending = 0, ResultRejected = 0 } }.ToList();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_monthlytestwisechart", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();

                        obj1.Batch = DBNull.Value.Equals(dr["Testname"]) ? "" : Convert.ToString(dr["Testname"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["Total"]) ? 0 : Convert.ToInt32(dr["Total"]);
                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }
        public List<SalesOrder> patienttab2()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { ResultApproval = 0, Resultpending = 0, ResultRejected = 0 } }.ToList();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_Repeatedpatientchart", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();

                        obj1.BillingPostalCode = DBNull.Value.Equals(dr["PatientName"]) ? "" : Convert.ToString(dr["PatientName"]);
                        obj1.ClientID = DBNull.Value.Equals(dr["NoOfTimes"]) ? 0 : Convert.ToInt32(dr["NoOfTimes"]);
                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }
        public List<SalesOrder> duetab1()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { ResultApproval = 0, Resultpending = 0, ResultRejected = 0 } }.ToList();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_duedetailpiechart", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();
                        obj1.ClientId1 = DBNull.Value.Equals(dr["Dues"]) ? 0 : Convert.ToInt32(dr["Dues"]);
                        obj1.Cond = DBNull.Value.Equals(dr["DueCollected"]) ? 0 : Convert.ToInt32(dr["DueCollected"]);
                        obj1.CreatedBy = DBNull.Value.Equals(dr["Total"]) ? 0 : Convert.ToInt32(dr["Total"]);
                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }
        public List<SalesOrder> duetab2()
        {
            List<SalesOrder> obj = new List<SalesOrder>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            var resultapproval = new[] { new { ResultApproval = 0, Resultpending = 0, ResultRejected = 0 } }.ToList();
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                conn.CreateCommand();
                using (cmd = new SqlCommand("sp_Paymentmodewisechart", conn))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        SalesOrder obj1 = new SalesOrder();

                        obj1.Custom1 = DBNull.Value.Equals(dr["payment"]) ? "" : Convert.ToString(dr["payment"]);
                        obj1.Customercategory = DBNull.Value.Equals(dr["no"]) ? 0 : Convert.ToInt32(dr["no"]);
                        obj.Add(obj1);
                    }
                }
            }
            return obj;
        }
        #endregion


        #region
        public void week()
        {
            List<Login> ac = new List<Login>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = new SqlCommand("sp_Inpatientcountbyweek", conn);
                cmd.CommandType = CommandType.StoredProcedure;
                dr = cmd.ExecuteReader();
                while (dr.Read())
                {
                    Login l = new Login();
                    ViewData["Sun1"] = Convert.ToString(dr["Sunday"]);
                    ViewData["Mon1"] = Convert.ToString(dr["Monday"]);
                    ViewData["Tue1"] = Convert.ToString(dr["Tuesday"]);
                    ViewData["Wed1"] = Convert.ToString(dr["Wednesday"]);
                    ViewData["Thu1"] = Convert.ToString(dr["Thursday"]);
                    ViewData["Fri1"] = Convert.ToString(dr["Friday"]);
                    ViewData["Sat1"] = Convert.ToString(dr["Saturday"]);


                }

            }
        }
        public void day()
        {
            List<Login> ac = new List<Login>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = new SqlCommand("sp_AnaliticPatientCountbytime11", conn);
                cmd.CommandType = CommandType.StoredProcedure;
                dr = cmd.ExecuteReader();
                while (dr.Read())
                {
                    Login l = new Login();
                    ViewData["count1"] = Convert.ToString(dr["count1"]);
                    ViewData["count2"] = Convert.ToString(dr["count2"]);
                    ViewData["count3"] = Convert.ToString(dr["count3"]);
                    ViewData["count4"] = Convert.ToString(dr["count4"]);
                    ViewData["count5"] = Convert.ToString(dr["count5"]);
                    ViewData["count6"] = Convert.ToString(dr["count6"]);
                    ViewData["count7"] = Convert.ToString(dr["count7"]);
                    ViewData["count8"] = Convert.ToString(dr["count8"]);
                    ViewData["count9"] = Convert.ToString(dr["count9"]);
                    ViewData["count10"] = Convert.ToString(dr["count10"]);
                    ViewData["count11"] = Convert.ToString(dr["count11"]);
                    ViewData["count12"] = Convert.ToString(dr["count12"]);
                }
            }
        }
        public void month()
        {
            List<Login> ac = new List<Login>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = new SqlCommand("sp_InPatientCountbymonth", conn);
                cmd.CommandType = CommandType.StoredProcedure;
                dr = cmd.ExecuteReader();
                while (dr.Read())
                {
                    Login l = new Login();
                    ViewData["January"] = Convert.ToString(dr["January"]);
                    ViewData["February"] = Convert.ToString(dr["February"]);
                    ViewData["March"] = Convert.ToString(dr["March"]);
                    ViewData["April"] = Convert.ToString(dr["April"]);
                    ViewData["May"] = Convert.ToString(dr["May"]);
                    ViewData["June"] = Convert.ToString(dr["June"]);
                    ViewData["July"] = Convert.ToString(dr["July"]);
                    ViewData["August"] = Convert.ToString(dr["August"]);
                    ViewData["September"] = Convert.ToString(dr["September"]);
                    ViewData["October"] = Convert.ToString(dr["October"]);
                    ViewData["November"] = Convert.ToString(dr["November"]);
                    ViewData["December"] = Convert.ToString(dr["December"]);
                }
            }
        }
        public ActionResult dischargePatients()
        {
            SqlConnection con = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            List<SalesOrder> li = new List<SalesOrder>();
            SalesOrder obj1;
            using (con = new SqlConnection(cs))
            {
                con.Open();
                con.CreateCommand();
                using (cmd = new SqlCommand("sp_dischargeInPatients", con))
                {
                    cmd.CommandType = CommandType.StoredProcedure;
                    dr = cmd.ExecuteReader();
                    while (dr.Read())
                    {
                        obj1 = new SalesOrder();
                        obj1.Amount = DBNull.Value.Equals(dr["TotalPatients"]) ? 0 : Convert.ToInt64(dr["TotalPatients"]);
                        obj1.AmountPaid = DBNull.Value.Equals(dr["DischargePatients"]) ? 0 : Convert.ToInt64(dr["DischargePatients"]);
                        obj1.BillAmount = DBNull.Value.Equals(dr["NotDischargePatient"]) ? 0 : Convert.ToInt64(dr["NotDischargePatient"]);
                        li.Add(obj1);
                    }
                }
                return Json(li, JsonRequestBehavior.AllowGet);
            }
        }
        public void DischargePatientbyweek()
        {
            List<Login> ac = new List<Login>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = new SqlCommand("sp_InpatientDischargebyweek", conn);
                cmd.CommandType = CommandType.StoredProcedure;
                dr = cmd.ExecuteReader();
                while (dr.Read())
                {
                    Login l = new Login();
                    ViewData["Sunday"] = Convert.ToString(dr["Sunday"]);
                    ViewData["Monday"] = Convert.ToString(dr["Monday"]);
                    ViewData["Tuesday"] = Convert.ToString(dr["Tuesday"]);
                    ViewData["Wednesday"] = Convert.ToString(dr["Wednesday"]);
                    ViewData["Thursday"] = Convert.ToString(dr["Thursday"]);
                    ViewData["Friday"] = Convert.ToString(dr["Friday"]);
                    ViewData["Saturday"] = Convert.ToString(dr["Saturday"]);


                }

            }
        }
        public void DischargePatientbyday()
        {
            List<Login> ac = new List<Login>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = new SqlCommand("sp_InPatientDischargeCountbytime", conn);
                cmd.CommandType = CommandType.StoredProcedure;
                dr = cmd.ExecuteReader();
                while (dr.Read())
                {
                    Login l = new Login();
                    ViewData["count11"] = Convert.ToString(dr["count1"]);
                    ViewData["count21"] = Convert.ToString(dr["count2"]);
                    ViewData["count31"] = Convert.ToString(dr["count3"]);
                    ViewData["count41"] = Convert.ToString(dr["count4"]);
                    ViewData["count51"] = Convert.ToString(dr["count5"]);
                    ViewData["count61"] = Convert.ToString(dr["count6"]);
                    ViewData["count71"] = Convert.ToString(dr["count7"]);
                    ViewData["count81"] = Convert.ToString(dr["count8"]);
                    ViewData["count91"] = Convert.ToString(dr["count9"]);
                    ViewData["count110"] = Convert.ToString(dr["count10"]);
                    ViewData["count111"] = Convert.ToString(dr["count11"]);
                    ViewData["count112"] = Convert.ToString(dr["count12"]);
                }
            }
        }
        public void DischargePatientbymonth()
        {
            List<Login> ac = new List<Login>();
            SqlConnection conn = null;
            SqlCommand cmd = null;
            SqlDataReader dr;
            using (conn = new SqlConnection(cs))
            {
                conn.Open();
                cmd = new SqlCommand("sp_InPatientDischargeCountbymonth", conn);
                cmd.CommandType = CommandType.StoredProcedure;
                dr = cmd.ExecuteReader();
                while (dr.Read())
                {
                    Login l = new Login();
                    ViewData["January1"] = Convert.ToString(dr["January"]);
                    ViewData["February1"] = Convert.ToString(dr["February"]);
                    ViewData["March1"] = Convert.ToString(dr["March"]);
                    ViewData["April1"] = Convert.ToString(dr["April"]);
                    ViewData["May1"] = Convert.ToString(dr["May"]);
                    ViewData["June1"] = Convert.ToString(dr["June"]);
                    ViewData["July1"] = Convert.ToString(dr["July"]);
                    ViewData["August1"] = Convert.ToString(dr["August"]);
                    ViewData["September1"] = Convert.ToString(dr["September"]);
                    ViewData["October1"] = Convert.ToString(dr["October"]);
                    ViewData["November1"] = Convert.ToString(dr["November"]);
                    ViewData["December1"] = Convert.ToString(dr["December"]);
                }
            }
        }
        #endregion





    }
}
---------------------------------------------------------------
Dictionary examples

<tbody>
                            @foreach (var item1 in ViewBag.val1 as Dictionary<string, int>)
                            {
                                i++;
                                if (i < 7)
                                {
                                <tr>
                                    <td style="white-space: nowrap">
                                        @item1.Key
                                    </td>
                                    <td>
                                        @item1.Value
                                    </td>
                                </tr>
                                }
                                else
                                {

                                }
                            }
                        </tbody>
	   



___________________-----------------------------------------------

with cte as
(select 1 i union all
 select i+1 i from cte where i < 5)
select dateadd(d, i-1, '2010-01-01') from cte






WITH cSequence
	AS (
		SELECT 1 AS StartRange
			,DATEADD(DD, 1, DATEADD(dd, - 1, @fromdate)) AS EndRange
		
		UNION ALL
		
		SELECT StartRange + 1
			,DATEADD(dd, 1, EndRange)
		FROM cSequence
		WHERE (
				DATEADD(dd, 1, EndRange) <= @todate
				--OR StartRange < 31
				)
		)

-----------------------------------------------------------------



declare @fromdate datetime
declare @todate datetime
DECLARE @temptable TABLE(dateapo varchar(30))

set @fromdate = '2016-02-01 00:00:00.000'
--set @todate = '2016-02-28 00:00:00.000'
--set @fromdate = CONVERT(VARCHAR(10), GETDATE(), 120)
set @todate = CONVERT(VARCHAR(10), DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,GETDATE())+1,0)), 120)


--select CONVERT(VARCHAR(10), GETDATE(), 103)
--select CONVERT(VARCHAR(10), GETDATE(), 105)
--SELECT CONVERT(VARCHAR(10), GETDATE(), 120) AS [YYYY-MM-DD]
--SELECT DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,GETDATE())+1,0))
--SELECT CONVERT(VARCHAR(10), DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,GETDATE())+1,0)), 120)
;WITH cSequence
	AS (
		SELECT 1 AS StartRange
			,DATEADD(DD, 1, DATEADD(dd, - 1, @fromdate)) AS EndRange
					
		UNION ALL
		
		SELECT StartRange + 1
			,DATEADD(dd, 1, EndRange)
			
		FROM cSequence
		WHERE (
				DATEADD(dd, 1, EndRange) <= @todate
				--OR StartRange < 31
				)
		)
		
		
       insert into @temptable select CONVERT(VARCHAR(10),EndRange, 103) from cSequence
	   --select b.dateapo from @temptable b
	   --select a.PatientName,a.AppointmentDate from appointment a 
	   SELECT c.PatientName,c.AppointmentDate,c.AppointmentTime,b.dateapo FROM @temptable b LEFT JOIN appointment c ON b.dateapo = c.AppointmentDate

	   



-----------------------------------------------------

if (scope.inputObj.disabledDates && scope.inputObj.disabledDates.length === 0) {
          scope.disabledDates = [];
        } else {
          angular.forEach(scope.inputObj.disabledDates, function (val, key) {
            val.setHours(0);
            val.setMinutes(0);
            val.setSeconds(0);
            val.setMilliseconds(0);

            scope.disabledDates.push(val.getTime());
          });
        }